org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * bezier scale handle handle { private point location private restore data private affine transform transform private point2 center private start theta private start length bezier scale handle bezier figure owner { super owner } combinable with handle { } draw graphics2 { draw circle color yellow color black } rectangle basic get bounds { rectangle = new rectangle get location grow get handlesize / 2 get handlesize / 2 } point get location { if location == { view drawing to view get origin } location } private bezier figure get bezier figure { bezier figure get owner } private point2 get origin { handlesize = get handlesize point2 outer = get bezier figure get outermost point point2 ctr = get bezier figure get center len = geom length outer outer ctr ctr if len == 0 { new point2 outer - handlesize/2 outer + handlesize/2 } = handlesize / len if > 1 0 { new point2 outer * 3 + ctr /4 outer * 3 + ctr /4 } else { new point2 outer * 1 0 - + ctr * outer * 1 0 - + ctr * } } track start point anchor modifiers { location = new point anchor anchor restore data = get bezier figure get restore data transform = new affine transform center = get bezier figure get center point2 anchor point = view view to drawing anchor start theta = geom angle center center anchor point anchor point start length = geom length center center anchor point anchor point } track step point anchor point modifiers { location = new point point2 point = view view to drawing step theta = geom angle center center point point step length = geom length center center point point scale factor = modifiers input event ALT_DOWN_MASK | input event SHIFT_DOWN_MASK != 0 ? 1d step length / start length transform set to identity transform translate center center transform scale scale factor scale factor transform rotate step theta - start theta transform translate -center -center get owner will change get owner restore to restore data get owner basic transform transform get owner changed } track point anchor point modifiers { view get drawing fire undoable edit happened new restore data edit get owner restore data location = } } 