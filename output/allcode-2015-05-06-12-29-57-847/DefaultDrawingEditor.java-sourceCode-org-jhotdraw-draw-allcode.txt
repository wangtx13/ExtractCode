org jhotdraw draw import org jhotdraw beans * import awt * import awt datatransfer * import awt event focus event import awt event focus listener import beans * import util * import * import org jhotdraw draw attribute keys * default drawing editor bean implements drawing editor tool listener { private hash map< attribute key object> default attributes = new hash map< attribute key object> private tool tool private hash set< drawing view> views private drawing view active view private enabled = private drawing view focused view private focus listener focus handler = new focus listener { focus gained focus event { set focused view drawing view find view container get source } focus lost focus event { if ! temporary { set focused view } } } default drawing editor { set default attribute FILL_COLOR color white set default attribute STROKE_COLOR color black set default attribute TEXT_COLOR color black views = new hash set< drawing view> } set tool tool { if == tool if tool != { for drawing view views { remove mouse listener tool remove mouse motion listener tool remove key listener tool } tool deactivate this tool remove tool listener this } tool = if tool != { tool activate this for drawing view views { add mouse listener tool add mouse motion listener tool add key listener tool } tool add tool listener this } } area invalidated tool event evt { rectangle = evt get invalidated area evt get view get container repaint width height } tool started tool event evt { set view evt get view } set view drawing view new value { drawing view old value = active view active view = new value fire property change view old value new value for drawing view views { get container repaint } } tool done tool event evt { drawing view = get view if != { container = get container invalidate if get parent != get parent validate } } tool get tool { tool } drawing view get view { active view != ? active view views iterator next } private update focused view { for drawing view views { if get container has focus { set focused view } } set focused view } private set focused view drawing view new value { drawing view old value = focused view focused view = new value fire property change focused view old value new value } drawing view get focused view { focused view } apply default attributes to figure { for map entry< attribute key object> entry default attributes entry set { set attribute entry get key entry get value } } get default attribute attribute key key { default attributes get key } set default attribute attribute key key new value { old value = default attributes put key new value fire property change key get key old value new value } remove drawing view view { view get container remove focus listener focus handler views remove view if tool != { view remove mouse listener tool view remove mouse motion listener tool view remove key listener tool } view remove notify this if active view == view { view = views size > 0 ? views iterator next } update focused view } add drawing view view { views add view view add notify this view get container add focus listener focus handler if tool != { view add mouse listener tool view add mouse motion listener tool view add key listener tool } update focused view } set cursor cursor { } collection< drawing view> get drawing views { collections unmodifiable collection views } drawing view find view container { for drawing view views { if get container == { } } } set enabled new value { if new value != enabled { old value = enabled enabled = new value fire property change enabled old value new value } } enabled { enabled } } 