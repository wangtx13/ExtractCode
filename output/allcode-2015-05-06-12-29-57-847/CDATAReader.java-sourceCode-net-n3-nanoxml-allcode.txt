net n3 nanoxml import reader import reader reader { private xml reader reader private char saved char private of data reader xml reader reader { this reader = reader this saved char = 0 this of data = } finalize throwable { this reader = super finalize } read char buffer offset size { chars read = 0 if this of data { -1 } if offset + size > buffer length { size = buffer length - offset } while chars read < size { char ch = this saved char if ch == 0 { ch = this reader read } else { this saved char = 0 } if ch == ' ' { char ch2 = this reader read if ch2 == ' ' { char ch3 = this reader read if ch3 == '>' { this of data = break } this saved char = ch2 this reader unread ch3 } else { this reader unread ch2 } } buffer chars read = ch chars read++ } if chars read == 0 { chars read = -1 } chars read } close { while ! this of data { char ch = this saved char if ch == 0 { ch = this reader read } else { this saved char = 0 } if ch == ' ' { char ch2 = this reader read if ch2 == ' ' { char ch3 = this reader read if ch3 == '>' { break } this saved char = ch2 this reader unread ch3 } else { this reader unread ch2 } } } this of data = } } 