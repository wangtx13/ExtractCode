org jhotdraw draw import util * import awt * import awt geom * import awt event * boxhandlekit box handle kit { boxhandlekit box handle kit { } addleadhandles add handles figure f collection<handle> collection< handle> handles { handles add southeast south east f handles add southwest south west f handles add northeast north east f handles add northwest north west f } addedgehandles add edge handles figure f collection<handle> collection< handle> handles { handles add south f handles add north f handles add east f handles add west f } addboxhandles add box handles figure f collection<handle> collection< handle> handles { addleadhandles add handles f handles addedgehandles add edge handles f handles } handle south figure owner { new southhandle south handle owner } handle southeast south east figure owner { new southeasthandle south east handle owner } handle southwest south west figure owner { new southwesthandle south west handle owner } handle north figure owner { new northhandle north handle owner } handle northeast north east figure owner { new northeasthandle north east handle owner } handle northwest north west figure owner { new northwesthandle north west handle owner } handle east figure owner { new easthandle east handle owner } handle west figure owner { new westhandle west handle owner } private resizehandle resize handle locatorhandle locator handle { private dx dy geometry resizehandle resize handle figure owner locator loc { super owner loc } trackstart track start point anchor modifiersex modifiers ex { geometry = getowner get owner getrestoredata get restore data point location = getlocation get location dx = anchor x + location x dy = anchor y + location y } trackstep track step point anchor point modifiersex modifiers ex { point2d point2 d p = view viewtodrawing view to drawing new point x + dx y + dy view getconstrainer get constrainer constrainpoint constrain point p trackstepnormalized track step normalized p } trackend track end point anchor point modifiersex modifiers ex { fireundoableedithappened fire undoable edit happened new geometryedit geometry edit getowner get owner geometry getowner get owner getrestoredata get restore data } trackstepnormalized track step normalized point2d point2 d p { } setbounds set bounds point2d point2 d anchor point2d point2 d { figure f = getowner get owner f willchange will change rectangle2d rectangle2 d oldbounds old bounds = f getbounds get bounds rectangle2d rectangle2 d newbounds new bounds = new rectangle2d rectangle2 d math min anchor x x math min anchor y y math abs anchor x x math abs anchor y y sx = newbounds new bounds width / oldbounds old bounds width sy = newbounds new bounds height / oldbounds old bounds height affinetransform affine transform tx = new affinetransform affine transform tx translate oldbounds old bounds x oldbounds old bounds y if ! isnan is na n sx ! isnan is na n sy sx != 1d || sy != 1d ! sx < 0 0001 ! sy < 0 0001 { f basictransform basic transform tx tx settoidentity set to identity tx scale sx sy f basictransform basic transform tx tx settoidentity set to identity } tx translate newbounds new bounds x newbounds new bounds y f basictransform basic transform tx f changed } } private northeasthandle north east handle resizehandle resize handle { northeasthandle north east handle figure owner { super owner relativelocator relative locator northeast north east } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d r x math min r y + r height 1 p y new point2d point2 d math max r x p x r y + r height } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor NE_RESIZE_CURSOR } } private easthandle east handle resizehandle resize handle { easthandle east handle figure owner { super owner relativelocator relative locator east } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d r x r y new point2d point2 d math max r x + 1 p x r y + r height } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor E_RESIZE_CURSOR } } private northhandle north handle resizehandle resize handle { northhandle north handle figure owner { super owner relativelocator relative locator north } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d r x math min r y + r height 1 p y new point2d point2 d r x + r width r y + r height } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor N_RESIZE_CURSOR } } private northwesthandle north west handle resizehandle resize handle { northwesthandle north west handle figure owner { super owner relativelocator relative locator northwest north west } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d math min r x + r width 1 p x math min r y + r height 1 p y new point2d point2 d r x + r width r y + r height } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor NW_RESIZE_CURSOR } } private southeasthandle south east handle resizehandle resize handle { southeasthandle south east handle figure owner { super owner relativelocator relative locator southeast south east } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d r x r y new point2d point2 d math max r x + 1 p x math max r y + 1 p y } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor SE_RESIZE_CURSOR } } private southhandle south handle resizehandle resize handle { southhandle south handle figure owner { super owner relativelocator relative locator south } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d r x r y new point2d point2 d r x + r width math max r y + 1 p y } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor S_RESIZE_CURSOR } } private southwesthandle south west handle resizehandle resize handle { southwesthandle south west handle figure owner { super owner relativelocator relative locator southwest south west } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d math min r x + r width 1 p x r y new point2d point2 d r x + r width math max r y + 1 p y } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor SW_RESIZE_CURSOR } } private westhandle west handle resizehandle resize handle { westhandle west handle figure owner { super owner relativelocator relative locator west } trackstepnormalized track step normalized point2d point2 d p { rectangle2d rectangle2 d r = getowner get owner getbounds get bounds setbounds set bounds new point2d point2 d math min r x + r width 1 p x r y new point2d point2 d r x + r width r y + r height } cursor getcursor get cursor { cursor getpredefinedcursor get predefined cursor cursor W_RESIZE_CURSOR } } } 