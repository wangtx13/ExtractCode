org jhotdraw draw import awt * import awt geom * gridconstrainer grid constrainer implements constrainer { private width height private color minorcolor minor color = new color 0xebebeb private color majorcolor major color = new color 0xcacaca gridconstrainer grid constrainer width height { if width <= 0 || height <= 0 throw new illegalargumentexception illegal argument width or height is <= 0 this width = width this height = height } getwidth get width { width } getheight get height { height } point2d point2 d constrainpoint constrain point point2d point2 d p { p x = math round p x / width * width p y = math round p y / height * height p } tostring to { super tostring to + +width+ +height+ } isvisible is visible { width > 1 height > 1 } draw graphics2d graphics2 d g drawingview drawing view view { if isvisible is visible { affinetransform affine transform t = view getdrawingtoviewtransform get drawing to view transform rectangle viewbounds view bounds = g getclipbounds get clip bounds rectangle2d rectangle2 d bounds = view viewtodrawing view to drawing viewbounds view bounds point2d point2 d origin = constrainpoint constrain point new point2d point2 d bounds x bounds y point2d point2 d point = new point2d point2 d point2d point2 d viewpoint view point = new point2d point2 d if width * view getscalefactor get scale factor > 1 { g setcolor set color minorcolor minor color for i= origin x / width m = origin x + bounds width / width + 1 i <= m i++ { g setcolor set color i % 5 == 0 ? majorcolor major color minorcolor minor color point x = width * i t transform point viewpoint view point g drawline draw line viewpoint view point x viewbounds view bounds y viewpoint view point x viewbounds view bounds y + viewbounds view bounds height } } if height * view getscalefactor get scale factor > 1 { g setcolor set color minorcolor minor color for i= origin y / height m = origin y + bounds height / height + 1 i <= m i++ { g setcolor set color i % 5 == 0 ? majorcolor major color minorcolor minor color point y = height * i t transform point viewpoint view point g drawline draw line viewbounds view bounds x viewpoint view point y viewbounds view bounds x + viewbounds view bounds width viewpoint view point y } } } } } 