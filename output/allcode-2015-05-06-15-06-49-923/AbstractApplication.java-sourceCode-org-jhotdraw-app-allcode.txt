org jhotdraw app import awt * import org jhotdraw beans * import org jhotdraw util * import util * import util prefs * import javax swing * import io * abstractapplication application abstractbean bean implements application { private linkedlist linked list projects = new linkedlist linked list private collection unmodifiabledocuments unmodifiable documents private isenabled is enabled = resourcebundleutil resource bundle util labels private applicationmodel application model model private linkedlist<file> linked list< file> recentfiles recent files = new linkedlist linked list private maxrecentfilescount max recent files count = 10 private preferences prefs abstractapplication application { } init { prefs = preferences usernodeforpackage user node for getmodel get model == ? getclass get getmodel get model getclass get count = prefs getint get recentfilecount recent count 0 for i=0 i < count i++ { path = prefs get recentfile recent +i if path != { recentfiles recent files add new path } } if model != { model initapplication init application this } } start { project p = createproject create project add p show p } project createproject create project { project p = basiccreateproject basic create project p init if getmodel get model != { getmodel get model initproject init project this p } initprojectactions init project actions p p } setmodel set model applicationmodel application model newvalue new value { applicationmodel application model oldvalue old value = model model = newvalue new value firepropertychange fire property change model oldvalue old value newvalue new value } applicationmodel application model getmodel get model { model } project basiccreateproject basic create project { model createproject create project } getname get name { model getname get name } getversion get { model getversion get } getcopyright get copyright { model getcopyright get copyright } initprojectactions init project actions project p stop { for project p new linkedlist<project> linked list< project> projects { dispose p } exit 0 } remove project p { hide p oldcount old count = projects size projects remove p p setapplication set application firepropertychange fire property change projectcount project count oldcount old count projects size } add project p { if p getapplication get application != this { oldcount old count = projects size projects add p p setapplication set application this firepropertychange fire property change projectcount project count oldcount old count projects size } } dispose project p { remove p p dispose } collection<project> collection< project> projects { if unmodifiabledocuments unmodifiable documents == { unmodifiabledocuments unmodifiable documents = collections unmodifiablecollection unmodifiable collection projects } unmodifiabledocuments unmodifiable documents } isenabled is enabled { isenabled is enabled } setenabled set enabled newvalue new value { oldvalue old value = isenabled is enabled isenabled is enabled = newvalue new value firepropertychange fire property change enabled oldvalue old value newvalue new value } container createcontainer create container { new jframe j frame } launch args { configure args swingutilities swing utilities invokelater later new runnable { run { init start } } } initlabels init labels { labels = resourcebundleutil resource bundle util getlafbundle get l a f bundle org jhotdraw app labels } configure args { } util list<file> list< file> recentfiles recent files { collections unmodifiablelist unmodifiable list recentfiles recent files } clearrecentfiles clear recent files { util list<file> list< file> oldvalue old value = util list<file> list< file> recentfiles recent files clone recentfiles recent files clear prefs putint put recentfilecount recent count recentfiles recent files size firepropertychange fire property change recentfiles recent files collections unmodifiablelist unmodifiable list oldvalue old value collections unmodifiablelist unmodifiable list recentfiles recent files } addrecentfile add recent { util list<file> list< file> oldvalue old value = util list<file> list< file> recentfiles recent files clone if recentfiles recent files contains { recentfiles recent files remove } recentfiles recent files addfirst add first if recentfiles recent files size > maxrecentfilescount max recent files count { recentfiles recent files removelast remove last } prefs putint put recentfilecount recent count recentfiles recent files size i=0 for f recentfiles recent files { prefs put recentfile recent +i f getpath get path i++ } firepropertychange fire property change recentfiles recent files oldvalue old value 0 firepropertychange fire property change recentfiles recent files collections unmodifiablelist unmodifiable list oldvalue old value collections unmodifiablelist unmodifiable list recentfiles recent files } } 