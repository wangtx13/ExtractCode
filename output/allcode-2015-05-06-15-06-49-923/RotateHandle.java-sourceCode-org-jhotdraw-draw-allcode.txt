org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * rotatehandle rotate handle abstracthandle handle { private point location private restoredata restore data private affinetransform affine transform transform private point2d point2 d center private starttheta start theta private startlength start length rotatehandle rotate handle figure owner { super owner } iscombinablewith is combinable with handle h { } draw graphics2d graphics2 d g { drawdiamond draw diamond g color green color black } rectangle basicgetbounds basic get bounds { rectangle r = new rectangle getlocation get location r grow gethandlesize get handlesize / 2 gethandlesize get handlesize / 2 r } point getlocation get location { if location == { view drawingtoview drawing to view getorigin get origin } location } private point2d point2 d getorigin get origin { rectangle2d rectangle2 d bounds = getowner get owner getbounds get bounds new point2d point2 d bounds getcenterx get center x bounds y gethandlesize get handlesize } trackstart track start point anchor modifiersex modifiers ex { location = new point anchor x anchor y restoredata restore data = getowner get owner getrestoredata get restore data rectangle2d rectangle2 d bounds = getowner get owner getbounds get bounds transform = new affinetransform affine transform center = new point2d point2 d bounds getcenterx get center x bounds getcentery get center y point2d point2 d anchorpoint anchor point = view viewtodrawing view to drawing anchor starttheta start theta = geom angle center x center y anchorpoint anchor point x anchorpoint anchor point y startlength start length = geom length center x center y anchorpoint anchor point x anchorpoint anchor point y } trackstep track step point anchor point modifiersex modifiers ex { location = new point x y point2d point2 d leadpoint point = view viewtodrawing view to drawing steptheta step theta = geom angle center x center y leadpoint point x leadpoint point y steplength step length = geom length center x center y leadpoint point x leadpoint point y transform settoidentity set to identity transform translate center x center y transform rotate steptheta step theta starttheta start theta transform translate center x center y getowner get owner willchange will change getowner get owner restoreto restore to restoredata restore data getowner get owner basictransform basic transform transform getowner get owner changed } trackend track end point anchor point modifiersex modifiers ex { view getdrawing get drawing fireundoableedithappened fire undoable edit happened new restoredataedit restore data edit getowner get owner restoredata restore data location = } } 