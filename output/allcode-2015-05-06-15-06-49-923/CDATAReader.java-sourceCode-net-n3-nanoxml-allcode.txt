net n3 nanoxml import io reader import io ioexception i o cdatareader c d a t a reader reader { private ixmlreader i xml reader reader private char savedchar saved char private atendofdata at end of data cdatareader c d a t a reader ixmlreader i xml reader reader { this reader = reader this savedchar saved char = 0 this atendofdata at end of data = } finalize throwable { this reader = super finalize } read char buffer offset size ioexception i o { charsread chars read = 0 if this atendofdata at end of data { 1 } if offset + size > buffer length { size = buffer length offset } while charsread chars read < size { char ch = this savedchar saved char if ch == 0 { ch = this reader read } else { this savedchar saved char = 0 } if ch == ' ' { char ch2 = this reader read if ch2 == ' ' { char ch3 = this reader read if ch3 == '>' { this atendofdata at end of data = break } this savedchar saved char = ch2 this reader unread ch3 } else { this reader unread ch2 } } buffer charsread chars read = ch charsread++ chars read++ } if charsread chars read == 0 { charsread chars read = 1 } charsread chars read } close ioexception i o { while ! this atendofdata at end of data { char ch = this savedchar saved char if ch == 0 { ch = this reader read } else { this savedchar saved char = 0 } if ch == ' ' { char ch2 = this reader read if ch2 == ' ' { char ch3 = this reader read if ch3 == '>' { break } this savedchar saved char = ch2 this reader unread ch3 } else { this reader unread ch2 } } } this atendofdata at end of data = } } 