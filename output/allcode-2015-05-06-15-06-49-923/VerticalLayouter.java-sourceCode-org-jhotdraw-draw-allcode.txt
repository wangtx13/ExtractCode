org jhotdraw draw import org jhotdraw util * import awt * import awt geom * import util * import org jhotdraw geom * import org jhotdraw draw attributekeys attribute keys * verticallayouter vertical layouter abstractlayouter layouter { rectangle2d rectangle2 d calculatelayout calculate layout compositefigure composite figure layoutable point2d point2 d anchor point2d point2 d { insets2ddouble insets2 d layoutinsets layout insets = LAYOUT_INSETS get layoutable if layoutinsets layout insets == layoutinsets layout insets = new insets2ddouble insets2 d 0 0 0 0 rectangle2d rectangle2 d layoutbounds layout bounds = new rectangle2d rectangle2 d anchor x anchor y 0 0 for figure child layoutable getchildren get children { if child isvisible is visible { dimension2ddouble dimension2 d preferredsize preferred size = child getpreferredsize get preferred size insets2ddouble insets2 d ins = getinsets get insets child layoutbounds layout bounds width = math max layoutbounds layout bounds width preferredsize preferred size width + ins left + ins right layoutbounds layout bounds height += preferredsize preferred size height + ins top + ins bottom } } layoutbounds layout bounds width += layoutinsets layout insets left + layoutinsets layout insets right layoutbounds layout bounds height += layoutinsets layout insets top + layoutinsets layout insets bottom layoutbounds layout bounds } rectangle2d rectangle2 d layout compositefigure composite figure layoutable point2d point2 d anchor point2d point2 d { insets2ddouble insets2 d layoutinsets layout insets = LAYOUT_INSETS get layoutable if layoutinsets layout insets == layoutinsets layout insets = new insets2ddouble insets2 d 0 0 0 0 rectangle2d rectangle2 d layoutbounds layout bounds = calculatelayout calculate layout layoutable anchor y = layoutbounds layout bounds y + layoutinsets layout insets top for figure child layoutable getchildren get children { if child isvisible is visible { insets2ddouble insets2 d insets = getinsets get insets child height = child getpreferredsize get preferred size height child basicsetbounds basic set bounds new point2d point2 d layoutbounds layout bounds x + layoutinsets layout insets left + insets left y + insets top new point2d point2 d layoutbounds layout bounds x + layoutbounds layout bounds width layoutinsets layout insets right insets right y + insets top + height y += height + insets top + insets bottom } } layoutbounds layout bounds } } 