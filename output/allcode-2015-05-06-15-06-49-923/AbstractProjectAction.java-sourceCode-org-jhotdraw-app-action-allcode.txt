org jhotdraw app action import awt * import awt event * import beans * import javax swing * import javax swing event * import org jhotdraw app application import org jhotdraw app project abstractprojectaction project action abstractaction action { private application app private propertychangelistener property change listener applicationlistener application listener = new propertychangelistener property change listener { propertychange property change propertychangeevent property change event evt { if evt getpropertyname get property name == currentproject current project { updateproject update project project evt getoldvalue get old value project evt getnewvalue get new value } } } private propertychangelistener property change listener projectlistener project listener = new propertychangelistener property change listener { propertychange property change propertychangeevent property change event evt { if evt getpropertyname get property name == enabled { updateenabled update enabled evt getoldvalue get old value evt getnewvalue get new value } } } abstractprojectaction project action application app { this app = app if app != { app addpropertychangelistener add property change listener applicationlistener application listener updateproject update project app getcurrentproject get current project } } updateproject update project project oldvalue old value project newvalue new value { if oldvalue old value != { uninstallprojectlisteners uninstall project listeners oldvalue old value } if newvalue new value != { installprojectlisteners install project listeners newvalue new value } firepropertychange fire property change project oldvalue old value newvalue new value updateenabled update enabled oldvalue old value != oldvalue old value isenabled is enabled newvalue new value != newvalue new value isenabled is enabled } installprojectlisteners install project listeners project p { p addpropertychangelistener add property change listener projectlistener project listener } uninstallprojectlisteners uninstall project listeners project p { p removepropertychangelistener remove property change listener projectlistener project listener } updateenabled update enabled oldvalue old value newvalue new value { setenabled set enabled super isenabled is enabled firepropertychange fire property change projectenabled project enabled oldvalue old value newvalue new value } application getapplication get application { app } project getcurrentproject get current project { app getcurrentproject get current project } @override @ override isenabled is enabled { getcurrentproject get current project != getcurrentproject get current project isenabled is enabled || super isenabled is enabled } @override @ override setenabled set enabled newvalue new value { oldvalue old value = this enabled this enabled = newvalue new value projisenabled proj is enabled = getcurrentproject get current project != getcurrentproject get current project isenabled is enabled firepropertychange fire property change enabled valueof value of oldvalue old value projisenabled proj is enabled valueof value of newvalue new value projisenabled proj is enabled } } 