org jhotdraw draw import awt * import awt event * selectiontool selection tool abstracttool tool implements toollistener tool listener { private tool tracker selectiontool selection tool { tracker = createareatracker create area tracker tracker addtoollistener add tool listener this } activate drawingeditor drawing editor editor { super activate editor tracker activate editor } deactivate drawingeditor drawing editor editor { super deactivate editor tracker deactivate editor } keypressed key pressed keyevent key event e { tracker keypressed key pressed e } keyreleased key released keyevent key event evt { tracker keyreleased key released evt } keytyped key typed keyevent key event evt { tracker keytyped key typed evt } mouseclicked mouse clicked mouseevent mouse event evt { tracker mouseclicked mouse clicked evt } mousedragged mouse dragged mouseevent mouse event evt { tracker mousedragged mouse dragged evt } mouseentered mouse entered mouseevent mouse event evt { super mouseentered mouse entered evt tracker mouseentered mouse entered evt } mouseexited mouse exited mouseevent mouse event evt { super mouseexited mouse exited evt tracker mouseexited mouse exited evt } mousemoved mouse moved mouseevent mouse event evt { tracker mousemoved mouse moved evt } mousereleased mouse released mouseevent mouse event evt { tracker mousereleased mouse released evt } draw graphics2d graphics2 d g { tracker draw g } mousepressed mouse pressed mouseevent mouse event evt { super mousepressed mouse pressed evt drawingview drawing view view = getview get view handle handle = view findhandle find handle anchor tool newtracker new tracker = if handle != { newtracker new tracker = createhandletracker create handle tracker handle } else { figure figure = view findfigure find figure anchor if figure != { newtracker new tracker = createdragtracker create drag tracker figure } else { if ! evt isshiftdown is shift down { view clearselection clear selection view sethandledetaillevel set handle detail level 0 } newtracker new tracker = createareatracker create area tracker } } if newtracker new tracker != { settracker set tracker newtracker new tracker } tracker mousepressed mouse pressed evt } settracker set tracker tool newtracker new tracker { if tracker != { tracker deactivate geteditor get editor tracker removetoollistener remove tool listener this } tracker = newtracker new tracker if tracker != { tracker activate geteditor get editor tracker addtoollistener add tool listener this } } tool createhandletracker create handle tracker handle handle { new handletracker handle tracker handle getview get view getcompatiblehandles get compatible handles handle } tool createdragtracker create drag tracker figure f { new dragtracker drag tracker f } tool createareatracker create area tracker { new selectareatracker select area tracker } toolstarted tool started toolevent tool event event { } tooldone tool done toolevent tool event event { tool newtracker new tracker = createareatracker create area tracker if newtracker new tracker != { if tracker != { tracker deactivate geteditor get editor tracker removetoollistener remove tool listener this } tracker = newtracker new tracker tracker activate geteditor get editor tracker addtoollistener add tool listener this } firetooldone fire tool done } areainvalidated area invalidated toolevent tool event e { fireareainvalidated fire area invalidated e getinvalidatedarea get invalidated area } } 