org jhotdraw util prefs import awt * import awt event * import util prefs * import javax swing * preferencesutil preferences util { private preferencesutil preferences util { } installframeprefshandler install frame prefs handler preferences prefs name window window { graphicsconfiguration graphics configuration conf = window getgraphicsconfiguration get graphics configuration rectangle screenbounds screen bounds = conf getbounds get bounds insets screeninsets screen insets = window gettoolkit get toolkit getscreeninsets get screen insets conf screenbounds screen bounds x += screeninsets screen insets left screenbounds screen bounds y += screeninsets screen insets top screenbounds screen bounds width = screeninsets screen insets left + screeninsets screen insets right screenbounds screen bounds height = screeninsets screen insets top + screeninsets screen insets bottom dimension preferredsize preferred size = window getpreferredsize get preferred size dimension minsize min size = window getminimumsize get minimum size rectangle bounds = new rectangle prefs getint get name+ x 0 prefs getint get name+ y 0 math max minsize min size width prefs getint get name+ width preferredsize preferred size width math max minsize min size height prefs getint get name+ height preferredsize preferred size height if ! screenbounds screen bounds contains bounds { bounds x = screenbounds screen bounds x + screenbounds screen bounds width bounds width / 2 bounds y = screenbounds screen bounds y + screenbounds screen bounds height bounds height / 2 rectangle intersect screenbounds screen bounds bounds bounds } window setbounds set bounds bounds window addcomponentlistener add component listener new componentadapter component adapter { componentmoved component moved componentevent component event evt { prefs putint put name+ x evt getcomponent get component getx get x prefs putint put name+ y evt getcomponent get component gety get y } componentresized component resized componentevent component event evt { prefs putint put name+ width evt getcomponent get component getwidth get width prefs putint put name+ height evt getcomponent get component getheight get height } } } installpaletteprefshandler install palette prefs handler preferences prefs name window window { installpaletteprefshandler install palette prefs handler prefs name window 0 } installpaletteprefshandler install palette prefs handler preferences prefs name window window x { graphicsconfiguration graphics configuration conf = window getgraphicsconfiguration get graphics configuration rectangle screenbounds screen bounds = conf getbounds get bounds insets screeninsets screen insets = window gettoolkit get toolkit getscreeninsets get screen insets conf screenbounds screen bounds x += screeninsets screen insets left screenbounds screen bounds y += screeninsets screen insets top screenbounds screen bounds width = screeninsets screen insets left + screeninsets screen insets right screenbounds screen bounds height = screeninsets screen insets top + screeninsets screen insets bottom dimension preferredsize preferred size = window getpreferredsize get preferred size rectangle bounds = new rectangle prefs getint get name+ x x + screenbounds screen bounds x prefs getint get name+ y 0 + screenbounds screen bounds y preferredsize preferred size width preferredsize preferred size height if ! screenbounds screen bounds contains bounds { bounds x = screenbounds screen bounds x bounds y = screenbounds screen bounds y } window setbounds set bounds bounds window addcomponentlistener add component listener new componentadapter component adapter { componentmoved component moved componentevent component event evt { prefs putint put name+ x evt getcomponent get component getx get x prefs putint put name+ y evt getcomponent get component gety get y } } } installinternalframeprefshandler install internal frame prefs handler preferences prefs name jinternalframe j internal frame window jdesktoppane j desktop pane desktop { rectangle screenbounds screen bounds = desktop getbounds get bounds screenbounds screen bounds setlocation set location 0 0 insets screeninsets screen insets = desktop getinsets get insets screenbounds screen bounds x += screeninsets screen insets left screenbounds screen bounds y += screeninsets screen insets top screenbounds screen bounds width = screeninsets screen insets left + screeninsets screen insets right screenbounds screen bounds height = screeninsets screen insets top + screeninsets screen insets bottom dimension preferredsize preferred size = window getpreferredsize get preferred size dimension minsize min size = window getminimumsize get minimum size rectangle bounds = new rectangle prefs getint get name+ x 0 prefs getint get name+ y 0 math max minsize min size width prefs getint get name+ width preferredsize preferred size width math max minsize min size height prefs getint get name+ height preferredsize preferred size height if ! screenbounds screen bounds contains bounds { bounds x = screenbounds screen bounds x + screenbounds screen bounds width bounds width / 2 bounds y = screenbounds screen bounds y + screenbounds screen bounds height bounds height / 2 rectangle intersect screenbounds screen bounds bounds bounds } window setbounds set bounds bounds window addcomponentlistener add component listener new componentadapter component adapter { componentmoved component moved componentevent component event evt { prefs putint put name+ x evt getcomponent get component getx get x prefs putint put name+ y evt getcomponent get component gety get y } componentresized component resized componentevent component event evt { prefs putint put name+ width evt getcomponent get component getwidth get width prefs putint put name+ height evt getcomponent get component getheight get height } } } installtoolbarprefshandler install tool bar prefs handler preferences prefs name jtoolbar j tool bar toolbar { new toolbarprefshandler tool bar prefs handler toolbar name prefs } } 