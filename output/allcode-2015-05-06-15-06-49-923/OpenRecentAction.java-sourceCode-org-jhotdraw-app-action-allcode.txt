org jhotdraw app action import org jhotdraw util * import org jhotdraw gui * import org jhotdraw gui event * import awt * import awt event * import util * import util prefs * import javax swing * import io * import org jhotdraw app application import org jhotdraw app project openrecentaction open recent action abstractapplicationaction application action { = openrecent open recent private openrecentaction open recent action application app { super app this = putvalue put value action name n a m e getname get name } actionperformed action performed actionevent action event evt { application app = getapplication get application if app isenabled is enabled { app setenabled set enabled project emptyproject empty project = app getcurrentproject get current project if emptyproject empty project == || emptyproject empty project getfile get != || emptyproject empty project hasunsavedchanges has unsaved changes { emptyproject empty project = } project p if emptyproject empty project == { p = app createproject create project app add p app show p } else { p = emptyproject empty project } openfile open p } } openfile open project project { application app = getapplication get application app setenabled set enabled multipleopenid multiple open = 1 for project aproject a project app projects { if aproject a project != project aproject a project getfile get != aproject a project getfile get equals { multipleopenid multiple open = math max multipleopenid multiple open aproject a project getmultipleopenid get multiple open + 1 } } project setmultipleopenid set multiple open multipleopenid multiple open project execute new worker { construct { try { project read } catch throwable e { e } } finished value { fileopened opened project value } } } fileopened opened project project value { application app = getapplication get application if value == { project setfile set project setenabled set enabled frame w = frame swingutilities swing utilities getwindowancestor get window ancestor project getcomponent get component if w != { w setextendedstate set extended state w getextendedstate get extended state ~frame ~ frame iconified i c o n i f i e d w tofront to front } project getcomponent get component requestfocus request focus if app != { app setenabled set enabled } } else { if value instanceof throwable { throwable value printstacktrace print stack trace } jsheet j sheet showmessagesheet show message sheet project getcomponent get component <html> +uimanager + u i manager getstring get optionpane option pane css + <b>couldn't <b> couldn't open the \ +file+ \ </b><br> + value joptionpane j option pane ERROR_MESSAGE new sheetlistener sheet listener { optionselected option selected sheetevent sheet event evt { } } } } } 