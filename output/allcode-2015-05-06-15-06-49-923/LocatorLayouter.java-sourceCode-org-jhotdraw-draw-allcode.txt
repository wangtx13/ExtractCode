org jhotdraw draw import org jhotdraw geom dimension2ddouble dimension2 d import org jhotdraw util * import awt * import awt geom * import util * locatorlayouter locator layouter implements layouter { attributekey<locator> attribute key< locator> LAYOUT_LOCATOR = new attributekey<locator> attribute key< locator> layoutlocator layout locator locatorlayouter locator layouter { } rectangle2d rectangle2 d calculatelayout calculate layout compositefigure composite figure compositefigure composite figure point2d point2 d anchor point2d point2 d { rectangle2d rectangle2 d bounds = for figure child compositefigure composite figure getchildren get children { locator locator = getlocator get locator child rectangle2d rectangle2 d r if locator == { r = child getbounds get bounds } else { point2d point2 d p = locator locate compositefigure composite figure dimension2ddouble dimension2 d d = child getpreferredsize get preferred size r = new rectangle2d rectangle2 d p x p y d width d height } if ! r isempty is empty { if bounds == { bounds = r } else { bounds add r } } } bounds == ? new rectangle2d rectangle2 d bounds } rectangle2d rectangle2 d layout compositefigure composite figure compositefigure composite figure point2d point2 d anchor point2d point2 d { rectangle2d rectangle2 d bounds = for figure child compositefigure composite figure getchildren get children { locator locator = getlocator get locator child rectangle2d rectangle2 d r if locator == { r = child getbounds get bounds } else { point2d point2 d p = locator locate compositefigure composite figure child dimension2ddouble dimension2 d d = child getpreferredsize get preferred size r = new rectangle2d rectangle2 d p x p y d width d height } child willchange will change child basicsetbounds basic set bounds new point2d point2 d r getminx get min x r getminy get min y new point2d point2 d r getmaxx get max x r getmaxy get max y child changed if ! r isempty is empty { if bounds == { bounds = r } else { bounds add r } } } bounds == ? new rectangle2d rectangle2 d bounds } private locator getlocator get locator figure f { locator f getattribute get attribute LAYOUT_LOCATOR } } 