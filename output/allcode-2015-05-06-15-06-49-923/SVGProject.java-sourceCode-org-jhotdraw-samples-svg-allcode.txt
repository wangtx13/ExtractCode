org jhotdraw samples svg import org jhotdraw gui * import org jhotdraw io * import org jhotdraw undo * import org jhotdraw util * import awt * import beans * import io * import lang reflect * import javax swing * import javax swing border * import org jhotdraw app * import org jhotdraw app action * import org jhotdraw draw * import org jhotdraw draw action * import org jhotdraw xml * svgproject s v g project abstractproject project { private undoredomanager undo redo manager undo private drawingeditor drawing editor editor svgproject s v g project { } init { super init initcomponents init components jpanel j panel zoombuttonpanel zoom button panel = new jpanel j panel new borderlayout border layout scrollpane scroll pane setlayout set layout new placardscrollpanelayout placard scroll pane layout scrollpane scroll pane setborder set border new emptyborder empty border 0 0 0 0 seteditor set editor new defaultdrawingeditor default drawing editor view setdomfactory set dom factory new svgfigurefactory s v g figure factory undo = new undoredomanager undo redo manager view setdrawing set drawing new svgdrawing s v g drawing view getdrawing get drawing addundoableeditlistener add undoable edit listener undo initactions init actions undo addpropertychangelistener add property change listener new propertychangelistener property change listener { propertychange property change propertychangeevent property change event evt { sethasunsavedchanges set has unsaved changes undo hassignificantedits has significant edits } } resourcebundleutil resource bundle util labels = resourcebundleutil resource bundle util getlafbundle get l a f bundle org jhotdraw draw labels jpanel j panel placardpanel placard panel = new jpanel j panel new borderlayout border layout javax swing abstractbutton button pbutton p button pbutton p button = toolbarbuttonfactory tool bar button factory createzoombutton create zoom button view pbutton p button putclientproperty put client property quaqua button style placard pbutton p button putclientproperty put client property quaqua component visualmargin visual margin new insets 0 0 0 0 pbutton p button setfont set font uimanager u i manager getfont get font smallsystemfont small font placardpanel placard panel add pbutton p button borderlayout border layout west w e s t pbutton p button = toolbarbuttonfactory tool bar button factory createtogglegridbutton create toggle grid button view pbutton p button putclientproperty put client property quaqua button style placard pbutton p button putclientproperty put client property quaqua component visualmargin visual margin new insets 0 0 0 0 pbutton p button setfont set font uimanager u i manager getfont get font smallsystemfont small font labels configuretoolbarbutton configure tool bar button pbutton p button aligngridsmall align grid small placardpanel placard panel add pbutton p button borderlayout border layout east e a s t scrollpane scroll pane add placardpanel placard panel jscrollpane j scroll pane LOWER_LEFT_CORNER } drawingeditor drawing editor geteditor get editor { editor } seteditor set editor drawingeditor drawing editor newvalue new value { drawingeditor drawing editor oldvalue old value = editor if oldvalue old value != { oldvalue old value remove view } editor = newvalue new value if newvalue new value != { newvalue new value add view } } private initactions init actions { putaction put action undoaction undo action undo getundoaction get undo action putaction put action redoaction redo action undo getredoaction get redo action } sethasunsavedchanges set has unsaved changes newvalue new value { super sethasunsavedchanges set has unsaved changes newvalue new value undo sethassignificantedits set has significant edits newvalue new value } write f ioexception i o { outputstream output stream out = try { out = new bufferedoutputstream buffered output stream new fileoutputstream output stream f nanoxmldomoutput nano xml dom output domo = new nanoxmldomoutput nano xml dom output view getdomfactory get dom factory domo setdoctype set doctype svg public p u b l i c \ \ http domo writeobject write view getdrawing get drawing domo save out } finally { if out != try { out close } catch ioexception i o e {} } } read f ioexception i o { inputstream input stream in = try { in = new bufferedinputstream buffered input stream new fileinputstream input stream f dominput dom input domi = new nanoxmldominput nano xml dom input view getdomfactory get dom factory in drawing drawing = drawing domi readobject read swingutilities swing utilities invokeandwait and wait new runnable { run { view getdrawing get drawing removeundoableeditlistener remove undoable edit listener undo view setdrawing set drawing drawing view getdrawing get drawing addundoableeditlistener add undoable edit listener undo undo discardalledits discard all edits }} } catch interruptedexception interrupted e { internalerror internal = new internalerror internal e initcause init cause e throw } catch invocationtargetexception invocation target e { internalerror internal = new internalerror internal e initcause init cause e throw } finally { if in != try { in close } catch ioexception i o e {} } } setdrawingeditor set drawing editor drawingeditor drawing editor newvalue new value { if editor != { editor remove view } editor = newvalue new value if editor != { editor add view } } drawingeditor drawing editor getdrawingeditor get drawing editor { editor } clear { view setdrawing set drawing new svgdrawing s v g drawing undo discardalledits discard all edits } @override @ override jfilechooser j chooser createopenchooser create open chooser { jfilechooser j chooser c = super createopenchooser create open chooser c addchoosablefilefilter add choosable filter new extensionfilefilter extension filter svg s v g drawing svg c } @override @ override jfilechooser j chooser createsavechooser create save chooser { jfilechooser j chooser c = super createsavechooser create save chooser c addchoosablefilefilter add choosable filter new extensionfilefilter extension filter svg s v g drawing svg c } private initcomponents init components { scrollpane scroll pane = new javax swing jscrollpane j scroll pane view = new org jhotdraw draw defaultdrawingview default drawing view setlayout set layout new awt borderlayout border layout scrollpane scroll pane sethorizontalscrollbarpolicy set horizontal scroll bar policy javax swing scrollpaneconstants scroll pane constants HORIZONTAL_SCROLLBAR_ALWAYS scrollpane scroll pane setverticalscrollbarpolicy set vertical scroll bar policy javax swing scrollpaneconstants scroll pane constants VERTICAL_SCROLLBAR_ALWAYS scrollpane scroll pane setviewportview set viewport view view add scrollpane scroll pane awt borderlayout border layout center c e n t e r } private javax swing jscrollpane j scroll pane scrollpane scroll pane private org jhotdraw draw defaultdrawingview default drawing view view } 