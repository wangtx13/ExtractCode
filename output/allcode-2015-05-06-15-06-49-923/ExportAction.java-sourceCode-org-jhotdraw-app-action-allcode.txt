org jhotdraw app action import org jhotdraw gui * import org jhotdraw gui event * import org jhotdraw util * import awt * import awt event * import javax swing * import io * import org jhotdraw app application import org jhotdraw app project exportaction export action abstractprojectaction project action { = export private component oldfocusowner old focus owner exportaction export action application app { super app resourcebundleutil resource bundle util labels = resourcebundleutil resource bundle util getlafbundle get l a f bundle org jhotdraw app labels labels configureaction configure action this } private jfilechooser j chooser getexportchooser get export chooser project project { try { jfilechooser j chooser project getexportchooser get export chooser } catch throwable e { internalerror internal = new internalerror internal project does not support exporting initcause init cause e throw } } actionperformed action performed actionevent action event evt { project project = getcurrentproject get current project if project isenabled is enabled { resourcebundleutil resource bundle util labels = resourcebundleutil resource bundle util getlafbundle get l a f bundle org jhotdraw app labels oldfocusowner old focus owner = swingutilities swing utilities getwindowancestor get window ancestor project getcomponent get component getfocusowner get focus owner project setenabled set enabled savetofile save to jfilechooser j chooser filechooser chooser = getexportchooser get export chooser project jsheet j sheet showsheet show sheet filechooser chooser project getcomponent get component labels getstring get filechooser export new sheetlistener sheet listener { optionselected option selected sheetevent sheet event evt { if evt getoption get option == jfilechooser j chooser APPROVE_OPTION { = evt getfilechooser get chooser getselectedfile get selected exporttofile export to project evt getfilechooser get chooser getfilefilter get filter evt getfilechooser get chooser getaccessory get accessory } else { project setenabled set enabled if oldfocusowner old focus owner != { oldfocusowner old focus owner requestfocus request focus } } } } } } exporttofile export to project project javax swing filechooser filefilter filter filter component accessory { project execute new worker { construct { try { project export new { javax swing filechooser filefilter filter component } filter accessory } catch internalerror internal e { e getcause get cause != ? e getcause get cause e } catch throwable e { e } } finished value { fileexported exported project value } } } fileexported exported project project value { if value == { } else { out flush throwable value printstacktrace print stack trace jsheet j sheet showmessagesheet show message sheet project getcomponent get component <html> +uimanager + u i manager getstring get optionpane option pane css + <b>couldn't <b> couldn't export to the \ +file+ \ <p> + reason +value joptionpane j option pane ERROR_MESSAGE } project setenabled set enabled swingutilities swing utilities getwindowancestor get window ancestor project getcomponent get component tofront to front if oldfocusowner old focus owner != { oldfocusowner old focus owner requestfocus request focus } } } 