org jhotdraw app action import org jhotdraw util * import awt event * import javax swing * import util * import beans * import awt * import org jhotdraw app defaultosxapplication default o s x application osxtogglepaletteaction o s x toggle palette action abstractaction action { private window palette private defaultosxapplication default o s x application app private windowlistener window listener windowhandler window handler osxtogglepaletteaction o s x toggle palette action defaultosxapplication default o s x application app window palette label { super label this app = app windowhandler window handler = new windowadapter window adapter { windowclosing window closing windowevent window event evt { putvalue put value actions SELECTED_KEY } } setpalette set palette palette putvalue put value actions SELECTED_KEY } putvalue put value key newvalue new value { super putvalue put value key newvalue new value if key == actions SELECTED_KEY { if palette != { b = newvalue new value if b { app addpalette add palette palette palette setvisible set visible } else { app removepalette remove palette palette palette setvisible set visible } } } } setpalette set palette window newvalue new value { if palette != { palette removewindowlistener remove window listener windowhandler window handler } palette = newvalue new value if palette != { palette addwindowlistener add window listener windowhandler window handler if getvalue get value actions SELECTED_KEY == true t r u e { app addpalette add palette palette palette setvisible set visible } else { app removepalette remove palette palette palette setvisible set visible } } } actionperformed action performed actionevent action event e { if palette != { putvalue put value actions SELECTED_KEY ! palette isvisible is visible } } } 