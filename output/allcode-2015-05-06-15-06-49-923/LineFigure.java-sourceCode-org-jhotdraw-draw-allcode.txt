org jhotdraw draw import javax swing undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * linefigure line figure bezierfigure bezier figure { linefigure line figure { basicaddnode basic add node new bezierpath bezier path node new point2d point2 d 0 0 basicaddnode basic add node new bezierpath bezier path node new point2d point2 d 0 0 } collection<handle> collection< handle> createhandles create handles detaillevel detail level { linkedlist<handle> linked list< handle> handles = new linkedlist<handle> linked list< handle> switch detaillevel detail level { case 0 for i=0 n = path size i < n i++ { handles add new beziernodehandle bezier node handle this i } break } handles } canconnect can connect { } handlemouseclick handle mouse click point2d point2 d p mouseevent mouse event evt drawingview drawing view view { if evt getclickcount get click count == 2 view gethandledetaillevel get handle detail level == 0 { willchange will change index = basicsplitsegment basic split segment p float 5f / view getscalefactor get scale factor if index != 1 { bezierpath bezier path node newnode new node = getnode get node index fireundoableedithappened fire undoable edit happened new abstractundoableedit undoable edit { redo cannotredoexception cannot redo { super redo willchange will change basicaddnode basic add node index newnode new node changed } undo cannotundoexception cannot undo { super undo willchange will change basicremovenode basic remove node index changed } } changed } } } } 