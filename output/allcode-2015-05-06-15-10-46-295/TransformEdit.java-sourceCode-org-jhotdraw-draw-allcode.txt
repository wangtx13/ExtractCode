org jhotdraw draw import org jhotdraw util * import javax swing undo * import awt geom * import util * transform edit undoable edit { private collection< figure> figures private affine transform tx transform edit figure figure affine transform tx { figures = new linked list< figure> linked list< figure> figures add figure this tx = affine transform tx clone } transform edit collection< figure> figures affine transform tx { this figures = figures this tx = affine transform tx clone } get presentation name { resource bundle util labels = resource bundle util get l a f bundle org jhotdraw draw labels locale get default labels get transform figure } add edit undoable edit an edit { if an edit instanceof transform edit { transform edit that = transform edit an edit if that figures == this figures { this tx concatenate that tx that die } } } replace edit undoable edit an edit { if an edit instanceof transform edit { transform edit that = transform edit an edit if that figures == this figures { this tx pre concatenate that tx that die } } } redo cannot redo { super redo for figure f figures { f will change f basic transform tx f changed } } undo cannot undo { super undo try { affine transform inverse = tx create inverse for figure f figures { f will change f basic transform inverse f changed } } catch noninvertible transform e { e print stack trace } } to { get get name +'@'+hash + tx +tx } } 