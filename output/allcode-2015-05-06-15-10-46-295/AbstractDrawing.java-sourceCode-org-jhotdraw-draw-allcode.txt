org jhotdraw draw import org jhotdraw beans * import org jhotdraw undo * import org jhotdraw xml * import awt * import awt geom * import awt font * import javax swing * import javax swing event * import javax swing undo * import org jhotdraw util * import util * import io * drawing bean implements drawing { private lock = new j panel get tree lock event listener list listener list = new event listener list private font render context font render context drawing { } add drawing listener drawing listener listener { listener list add drawing listener listener } remove drawing listener drawing listener listener { listener list remove drawing listener listener } add undoable edit listener undoable edit listener l { listener list add undoable edit listener l } remove undoable edit listener undoable edit listener l { listener list remove undoable edit listener l } add all collection< figure> figures { composite edit edit = new composite edit figuren hinzuf\u00fcgen fire undoable edit happened edit for figure f figures { add f } fire undoable edit happened edit } clear { remove all get figures } get figure count { get figures size } remove all collection< figure> to be removed { composite edit edit = new composite edit figuren entfernen fire undoable edit happened edit for figure f new list< figure> to be removed { remove f } fire undoable edit happened edit } basic add all collection< figure> figures { for figure f figures { basic add f } } basic remove all collection< figure> to be orphaned { for figure f new list< figure> to be orphaned { basic remove f } } add figure figure { index = get figure count basic add index figure figure add notify this fire figure added figure fire undoable edit happened new undoable edit { get presentation name { figur einf\u00fcgen } undo cannot undo { super undo basic remove figure figure remove notify drawing this fire figure removed figure } redo cannot undo { super redo basic add index figure figure add notify drawing this fire figure added figure } } } basic add figure figure { basic add get figure count figure } remove figure figure { if contains figure { index = index of figure basic remove figure figure remove notify this fire figure removed figure fire undoable edit happened new undoable edit { get presentation name { figur entfernen } redo cannot undo { super redo basic remove figure figure remove notify drawing this fire figure removed figure } undo cannot undo { super undo basic add index figure figure add notify drawing this fire figure added figure } } } else { fire area invalidated figure get draw bounds } } index of figure figure fire area invalidated rectangle2 d dirty region { drawing event event = listeners = listener list get listener list for i = listeners length 2 i>=0 i =2 { if listeners i == drawing listener { if event == event = new drawing event this dirty region drawing listener listeners i+1 area invalidated event } } } fire undoable edit happened undoable edit edit { undoable edit event event = if listener list get listener count > 0 { listeners = listener list get listener list for i = listeners length 2 i>=0 i =2 { if event == event = new undoable edit event this edit if listeners i == undoable edit listener { undoable edit listener listeners i+1 undoable edit happened event } } } } fire figure added figure f { drawing event event = listeners = listener list get listener list for i = listeners length 2 i>=0 i =2 { if listeners i == drawing listener { if event == event = new drawing event this f f get draw bounds drawing listener listeners i+1 figure added event } } } fire figure removed figure f { drawing event event = listeners = listener list get listener list for i = listeners length 2 i>=0 i =2 { if listeners i == drawing listener { if event == event = new drawing event this f f get draw bounds drawing listener listeners i+1 figure removed event } } } font render context get font render context { font render context } set font render context font render context frc { font render context = frc } read dom input in i o { in open element figures for i=0 i < in get element count i++ { figure f add f = figure in read i } in close element } write dom output out i o { out open element figures for figure f get figures { out write f } out close element } get lock { lock } } 