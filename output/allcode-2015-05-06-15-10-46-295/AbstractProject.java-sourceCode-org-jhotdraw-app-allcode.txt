org jhotdraw app import org jhotdraw app action select all action import io * import util * import org jhotdraw util * import javax swing * import util concurrent * import util prefs * project j panel implements project { private application application j chooser save chooser j chooser open chooser executor executor private hash map actions private has unsaved changes private preferences prefs private multiple open = 1 private is showing project { } init { prefs = preferences user node for get init components } private init components { set layout new awt border layout } set application application new value { application old value = application application = new value fire property change application old value new value } application get application { application } j component get component { this } get { } set new value { old value = = new value if prefs != new value != { prefs put project new value get path } fire property change old value new value } j chooser get open chooser { if open chooser == { open chooser = create open chooser } open chooser } j chooser create open chooser { j chooser c = new j chooser if prefs != { c set selected new prefs get project get property user home } c } j chooser get save chooser { if save chooser == { save chooser = create save chooser } save chooser } j chooser create save chooser { j chooser c = new j chooser if prefs != { c set current directory new prefs get project get property user home } c } has unsaved changes { has unsaved changes } set has unsaved changes new value { old value = has unsaved changes has unsaved changes = new value fire property change has unsaved changes old value new value } dispose { } action get action { actions == ? action actions get } put action action action { if actions == { actions = new hash map } if action == { actions remove } else { actions put action } } execute runnable worker { if executor == { executor = executors new single thread executor } executor execute worker } set multiple open new value { old value = multiple open multiple open = new value fire property change multiple open old value new value } get multiple open { multiple open } set showing new value { old value = is showing is showing = new value fire property change showing old value new value } is showing { is showing } mark changes as saved { set has unsaved changes } } 