org jhotdraw draw import org jhotdraw util * import awt * import awt geom * import org jhotdraw draw attribute keys * import org jhotdraw geom * chop round rect connector chop box connector { chop round rect connector { } chop round rect connector figure owner { super owner } point2 d chop figure target point2 d from { target = get connector target target round rectangle figure rrf = round rectangle figure target rectangle2 d outer = rrf get bounds grow switch STROKE_PLACEMENT get target { case c e n t e r default grow = attribute keys get stroke total width target / 2d break case o u t sid e grow = attribute keys get stroke total width target break case i n sid e grow = 0 break } geom grow outer grow grow rectangle2 d inner = rectangle2 d outer clone gw = rrf get arc width + grow * 2 / 2 gh = rrf get arc height + grow *2 / 2 inner x = gw inner y = gh inner width += gw * 2 inner height += gh * 2 angle = geom point to angle outer from point2 d p = geom angle to point outer geom point to angle outer from if p x == outer x || p x == outer x + outer width { p y = math min math max p y inner y inner y + inner height } else { p x = math min math max p x inner x inner x + inner width } p } } 