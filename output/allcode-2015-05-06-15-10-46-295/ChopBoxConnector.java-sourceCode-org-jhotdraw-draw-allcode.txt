org jhotdraw draw import org jhotdraw util * import awt * import awt geom * import org jhotdraw draw attribute keys * import org jhotdraw geom * chop box connector connector { chop box connector { } chop box connector figure owner { super owner } point2 d find start connection figure connection { figure start figure = connection get start connector get owner point2 d from if connection get point count <= 2 || connection get liner != { if connection get end connector == { from = connection get end point } else { rectangle2 d r1 = get connector target connection get end connector get owner get bounds from = new point2 d r1 x + r1 width/2 r1 y + r1 height/2 } } else { from = connection get point 1 } chop start figure from } point2 d find end connection figure connection { figure end figure = connection get end connector get owner point2 d from if connection get point count <= 2 || connection get liner != { if connection get start connector == { from = connection get start point } else { rectangle2 d r1 = get connector target connection get start connector get owner get bounds from = new point2 d r1 x + r1 width/2 r1 y + r1 height/2 } } else { from = connection get point connection get point count 2 } chop end figure from } point2 d chop figure target point2 d from { target = get connector target target rectangle2 d r = target get bounds if STROKE_COLOR get target != { grow switch STROKE_PLACEMENT get target { case c e n t e r default grow = attribute keys get stroke total width target / 2d break case o u t sid e grow = attribute keys get stroke total width target break case i n sid e grow = 0d break } geom grow r grow grow } geom angle to point r geom point to angle r from } } 