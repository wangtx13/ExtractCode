org jhotdraw draw import org jhotdraw geom dimension2 d import org jhotdraw util * import awt * import awt geom * import util * locator layouter implements layouter { attribute key< locator> LAYOUT_LOCATOR = new attribute key< locator> layout locator locator layouter { } rectangle2 d calculate layout composite figure composite figure point2 d anchor point2 d { rectangle2 d bounds = for figure child composite figure get children { locator locator = get locator child rectangle2 d r if locator == { r = child get bounds } else { point2 d p = locator locate composite figure dimension2 d d = child get preferred size r = new rectangle2 d p x p y d width d height } if ! r is empty { if bounds == { bounds = r } else { bounds add r } } } bounds == ? new rectangle2 d bounds } rectangle2 d layout composite figure composite figure point2 d anchor point2 d { rectangle2 d bounds = for figure child composite figure get children { locator locator = get locator child rectangle2 d r if locator == { r = child get bounds } else { point2 d p = locator locate composite figure child dimension2 d d = child get preferred size r = new rectangle2 d p x p y d width d height } child will change child basic set bounds new point2 d r get min x r get min y new point2 d r get max x r get max y child changed if ! r is empty { if bounds == { bounds = r } else { bounds add r } } } bounds == ? new rectangle2 d bounds } private locator get locator figure f { locator f get attribute LAYOUT_LOCATOR } } 