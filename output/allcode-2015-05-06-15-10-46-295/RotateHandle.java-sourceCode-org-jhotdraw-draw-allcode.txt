org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * rotate handle handle { private point location private restore data private affine transform transform private point2 d center private start theta private start length rotate handle figure owner { super owner } is combinable with handle h { } draw graphics2 d g { draw diamond g color green color black } rectangle basic get bounds { rectangle r = new rectangle get location r grow get handlesize / 2 get handlesize / 2 r } point get location { if location == { view drawing to view get origin } location } private point2 d get origin { rectangle2 d bounds = get owner get bounds new point2 d bounds get center x bounds y get handlesize } track start point anchor modifiers ex { location = new point anchor x anchor y restore data = get owner get restore data rectangle2 d bounds = get owner get bounds transform = new affine transform center = new point2 d bounds get center x bounds get center y point2 d anchor point = view view to drawing anchor start theta = geom angle center x center y anchor point x anchor point y start length = geom length center x center y anchor point x anchor point y } track step point anchor point modifiers ex { location = new point x y point2 d point = view view to drawing step theta = geom angle center x center y point x point y step length = geom length center x center y point x point y transform set to identity transform translate center x center y transform rotate step theta start theta transform translate center x center y get owner will change get owner restore to restore data get owner basic transform transform get owner changed } track end point anchor point modifiers ex { view get drawing fire undoable edit happened new restore data edit get owner restore data location = } } 