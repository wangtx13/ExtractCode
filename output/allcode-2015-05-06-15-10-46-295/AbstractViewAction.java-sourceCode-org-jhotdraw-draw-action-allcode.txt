org jhotdraw draw action import org jhotdraw draw drawing import org jhotdraw draw drawing editor import org jhotdraw draw drawing view import org jhotdraw util * import beans * import javax swing * import javax swing undo * import util * view action action { private drawing editor editor private drawing view view resource bundle util labels = resource bundle util get l a f bundle org jhotdraw draw labels locale get default private property change listener property change handler = new property change listener { property change property change event evt { if evt get property name equals enabled { update enabled state } } } view action drawing editor editor { this editor = editor editor add property change listener new property change listener { property change property change event evt { if evt get property name equals view { if evt get old value != { drawing view view = drawing view evt get old value view remove property change listener property change handler } if evt get new value != { drawing view view = drawing view evt get old value view add property change listener property change handler update enabled state } } } } } view action drawing view view { this view = view } set editor drawing editor new value { editor = new value } drawing view get view { view != ? view editor get view } drawing get drawing { get view get drawing } fire undoable edit happened undoable edit edit { get drawing fire undoable edit happened edit } view changed { } update enabled state { if get view != { set enabled get view is enabled get view get selection count > 0 } else { set enabled } } } 