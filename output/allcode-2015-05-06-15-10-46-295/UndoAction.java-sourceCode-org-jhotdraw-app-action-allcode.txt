org jhotdraw app action import awt * import awt event * import javax swing * import javax swing text * import beans * import util * import org jhotdraw util * import org jhotdraw app application import org jhotdraw app project undo action project action { = undo private resource bundle util labels = resource bundle util get l a f bundle org jhotdraw app labels private property change listener redo action property listener = new property change listener { property change property change event evt { name = evt get property name if name == action n a m e { put value action n a m e evt get new value } else if name == enabled { update enabled state } } } undo action application app { super app labels configure action this } update enabled state { is enabled = action real redo action = get real redo action if real redo action != { is enabled = real redo action is enabled } set enabled is enabled } @ override update project project old value project new value { super update project old value new value if new value != { put value action n a m e new value get action undo get value action n a m e update enabled state } } @ override install project listeners project p { super install project listeners p p get action undo add property change listener redo action property listener } @ override uninstall project listeners project p { super uninstall project listeners p p get action undo remove property change listener redo action property listener } action performed action event e { action real redo action = get real redo action if real redo action != { real redo action action performed e } } private action get real redo action { get current project == ? get current project get action undo } } 