org jhotdraw draw import awt * import awt geom * grid constrainer implements constrainer { private width height private color minor color = new color 0xebebeb private color major color = new color 0xcacaca grid constrainer width height { if width <= 0 || height <= 0 throw new illegal argument width or height is <= 0 this width = width this height = height } get width { width } get height { height } point2 d constrain point point2 d p { p x = math round p x / width * width p y = math round p y / height * height p } to { super to + +width+ +height+ } is visible { width > 1 height > 1 } draw graphics2 d g drawing view view { if is visible { affine transform t = view get drawing to view transform rectangle view bounds = g get clip bounds rectangle2 d bounds = view view to drawing view bounds point2 d origin = constrain point new point2 d bounds x bounds y point2 d point = new point2 d point2 d view point = new point2 d if width * view get scale factor > 1 { g set color minor color for i= origin x / width m = origin x + bounds width / width + 1 i <= m i++ { g set color i % 5 == 0 ? major color minor color point x = width * i t transform point view point g draw line view point x view bounds y view point x view bounds y + view bounds height } } if height * view get scale factor > 1 { g set color minor color for i= origin y / height m = origin y + bounds height / height + 1 i <= m i++ { g set color i % 5 == 0 ? major color minor color point y = height * i t transform point view point g draw line view bounds x view point y view bounds x + view bounds width view point y } } } } } 