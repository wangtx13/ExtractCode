net n3 nanoxml import io print stream import io print writer xml { private msg private systemid private line nr private encapsulated xml msg { this 1 msg } xml e { this 1 e nested } xml systemid line nr e { this systemid line nr e nested } xml systemid line nr msg { this systemid line nr msg } xml systemid line nr e msg report params { super xml build message systemid line nr e msg report params this systemid = systemid this line nr = line nr this encapsulated = e this msg = xml build message systemid line nr e msg report params } private build message systemid line nr e msg report params { str = msg if report params { if systemid != { str += systemid=' + systemid + ' } if line nr >= 0 { str += line= + line nr } if e != { str += + e } } str } finalize throwable { this systemid = this encapsulated = super finalize } get systemid { this systemid } get line nr { this line nr } get { this encapsulated } print stack trace print writer writer { super print stack trace writer if this encapsulated != { writer *** nested this encapsulated print stack trace writer } } print stack trace print stream stream { super print stack trace stream if this encapsulated != { stream *** nested this encapsulated print stack trace stream } } print stack trace { super print stack trace if this encapsulated != { err *** nested this encapsulated print stack trace } } to { this msg } } 