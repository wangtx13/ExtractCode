org jhotdraw util prefs import awt * import awt event * import util prefs * import javax swing * import javax swing plaf basic * import javax swing event * tool bar prefs handler implements component listener ancestor listener { private j tool bar toolbar private prefs prefix private preferences prefs private first time shown tool bar prefs handler j tool bar toolbar prefs prefix preferences prefs { this toolbar = toolbar this prefs prefix = prefs prefix this prefs = prefs constraint = prefs get prefs prefix+ constraint border layout n o r t h orientation = constraint equals border layout n o r t h || constraint equals border layout s o u t h ? j tool bar h o r i z o n t a l j tool bar v e r t i c a l toolbar set orientation orientation toolbar get parent add constraint toolbar toolbar set visible prefs get prefs prefix+ visible toolbar add component listener this toolbar add ancestor listener this } component hidden component event e { prefs put prefs prefix+ visible } component moved component event e { location changed } private location changed { if toolbar get u i instanceof basic tool bar u i { basic tool bar u i ui = basic tool bar u i toolbar get u i floating = ui is floating prefs put prefs prefix+ is floating floating if floating { window window = swing utilities get window ancestor toolbar prefs put prefs prefix+ floating x window get x prefs put prefs prefix+ floating y window get y } else if toolbar get parent != { x = toolbar get x y = toolbar get y insets insets = toolbar get parent get insets constraint if x == insets left y == insets top { constraint = toolbar get orientation == j tool bar h o r i z o n t a l ? border layout n o r t h border layout w e s t } else { constraint = toolbar get orientation == j tool bar h o r i z o n t a l ? border layout s o u t h border layout e a s t } prefs put prefs prefix+ constraint constraint } } else { if toolbar get parent != { x = toolbar get x y = toolbar get y insets insets = toolbar get parent get insets constraint if x == insets left y == insets top { constraint = toolbar get orientation == j tool bar h o r i z o n t a l ? border layout n o r t h border layout w e s t } else { constraint = toolbar get orientation == j tool bar h o r i z o n t a l ? border layout s o u t h border layout e a s t } prefs put prefs prefix+ constraint constraint } } } component resized component event e { location changed } component shown component event e { prefs put prefs prefix+ visible } ancestor added ancestor event event { location changed } ancestor moved ancestor event event { if toolbar get u i instanceof basic tool bar u i { if basic tool bar u i toolbar get u i is floating { location changed } } } ancestor removed ancestor event event { if toolbar get u i instanceof basic tool bar u i { if basic tool bar u i toolbar get u i is floating { location changed } } } } 