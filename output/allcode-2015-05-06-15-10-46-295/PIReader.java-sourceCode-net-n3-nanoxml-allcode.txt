net n3 nanoxml import io reader import io i o p i reader reader { private i xml reader reader private at end of data p i reader i xml reader reader { this reader = reader this at end of data = } finalize throwable { this reader = super finalize } read char buffer offset size i o { if this at end of data { 1 } chars read = 0 if offset + size > buffer length { size = buffer length offset } while chars read < size { char ch = this reader read if ch == '?' { char ch2 = this reader read if ch2 == '>' { this at end of data = break } this reader unread ch2 } buffer chars read = ch chars read++ } if chars read == 0 { chars read = 1 } chars read } close i o { while ! this at end of data { char ch = this reader read if ch == '?' { char ch2 = this reader read if ch2 == '>' { this at end of data = } } } } } 