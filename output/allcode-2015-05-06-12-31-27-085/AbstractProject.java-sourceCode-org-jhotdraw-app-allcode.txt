org jhotdraw app import org jhotdraw app action SelectAllAction select all action import * import util * import org jhotdraw util * import javax swing * import util concurrent * import util prefs * AbstractProject project JPanel panel implements project { private application application JFileChooser chooser saveChooser save chooser JFileChooser chooser openChooser open chooser executor executor private HashMap hash map actions private hasUnsavedChanges has unsaved changes private preferences prefs private multipleOpenId multiple open = 1 private isShowing showing AbstractProject project { } init { prefs = preferences userNodeForPackage user node for getClass get initComponents init components } private initComponents init components { setLayout set layout new awt BorderLayout border layout } setApplication set application application newValue new value { application oldValue old value = application application = newValue new value firePropertyChange fire property change application oldValue old value newValue new value } application getApplication get application { application } JComponent component getComponent get component { this } getFile get { } setFile set newValue new value { oldValue old value = = newValue new value if prefs != newValue new value != { prefs put projectFile project newValue new value getPath get path } firePropertyChange fire property change oldValue old value newValue new value } JFileChooser chooser getOpenChooser get open chooser { if openChooser open chooser == { openChooser open chooser = createOpenChooser create open chooser } openChooser open chooser } JFileChooser chooser createOpenChooser create open chooser { JFileChooser chooser = new JFileChooser chooser if prefs != { setSelectedFile set selected new prefs get projectFile project getProperty get property user home } } JFileChooser chooser getSaveChooser get save chooser { if saveChooser save chooser == { saveChooser save chooser = createSaveChooser create save chooser } saveChooser save chooser } JFileChooser chooser createSaveChooser create save chooser { JFileChooser chooser = new JFileChooser chooser if prefs != { setCurrentDirectory set current directory new prefs get projectFile project getProperty get property user home } } hasUnsavedChanges has unsaved changes { hasUnsavedChanges has unsaved changes } setHasUnsavedChanges set has unsaved changes newValue new value { oldValue old value = hasUnsavedChanges has unsaved changes hasUnsavedChanges has unsaved changes = newValue new value firePropertyChange fire property change hasUnsavedChanges has unsaved changes oldValue old value newValue new value } dispose { } action getAction get action { actions == ? action actions get } putAction put action action action { if actions == { actions = new HashMap hash map } if action == { actions remove } else { actions put action } } execute runnable worker { if executor == { executor = executors newSingleThreadExecutor new single thread executor } executor execute worker } setMultipleOpenId set multiple open newValue new value { oldValue old value = multipleOpenId multiple open multipleOpenId multiple open = newValue new value firePropertyChange fire property change multipleOpenId multiple open oldValue old value newValue new value } getMultipleOpenId get multiple open { multipleOpenId multiple open } setShowing set showing newValue new value { oldValue old value = isShowing showing isShowing showing = newValue new value firePropertyChange fire property change showing oldValue old value newValue new value } isShowing showing { isShowing showing } markChangesAsSaved mark changes saved { setHasUnsavedChanges set has unsaved changes } } 