org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * BezierScaleHandle bezier scale handle AbstractHandle handle { private point location private restoreData restore data private AffineTransform affine transform transform private Point2D point2 center private startTheta start theta private startLength start length BezierScaleHandle bezier scale handle BezierFigure bezier figure owner { super owner } isCombinableWith combinable with handle { } draw Graphics2D graphics2 { drawCircle draw circle color yellow color black } rectangle basicGetBounds basic get bounds { rectangle = new rectangle getLocation get location grow getHandlesize get handlesize / 2 getHandlesize get handlesize / 2 } point getLocation get location { if location == { view drawingToView drawing to view getOrigin get origin } location } private BezierFigure bezier figure getBezierFigure get bezier figure { BezierFigure bezier figure getOwner get owner } private Point2D point2 getOrigin get origin { handlesize = getHandlesize get handlesize Point2D point2 outer = getBezierFigure get bezier figure getOutermostPoint get outermost point Point2D point2 ctr = getBezierFigure get bezier figure getCenter get center len = geom length outer outer ctr ctr if len == 0 { new Point2D point2 outer - handlesize/2 outer + handlesize/2 } = handlesize / len if > 1 0 { new Point2D point2 outer * 3 + ctr /4 outer * 3 + ctr /4 } else { new Point2D point2 outer * 1 0 - + ctr * outer * 1 0 - + ctr * } } trackStart track start point anchor modifiersEx modifiers { location = new point anchor anchor restoreData restore data = getBezierFigure get bezier figure getRestoreData get restore data transform = new AffineTransform affine transform center = getBezierFigure get bezier figure getCenter get center Point2D point2 anchorPoint anchor point = view viewToDrawing view to drawing anchor startTheta start theta = geom angle center center anchorPoint anchor point anchorPoint anchor point startLength start length = geom length center center anchorPoint anchor point anchorPoint anchor point } trackStep track step point anchor point modifiersEx modifiers { location = new point Point2D point2 leadPoint point = view viewToDrawing view to drawing stepTheta step theta = geom angle center center leadPoint point leadPoint point stepLength step length = geom length center center leadPoint point leadPoint point scaleFactor scale factor = modifiersEx modifiers InputEvent input event ALT_DOWN_MASK | InputEvent input event SHIFT_DOWN_MASK != 0 ? 1d stepLength step length / startLength start length transform setToIdentity set to identity transform translate center center transform scale scaleFactor scale factor scaleFactor scale factor transform rotate stepTheta step theta - startTheta start theta transform translate -center -center getOwner get owner willChange will change getOwner get owner restoreTo restore to restoreData restore data getOwner get owner basicTransform basic transform transform getOwner get owner changed } trackEnd track point anchor point modifiersEx modifiers { view getDrawing get drawing fireUndoableEditHappened fire undoable edit happened new RestoreDataEdit restore data edit getOwner get owner restoreData restore data location = } } 