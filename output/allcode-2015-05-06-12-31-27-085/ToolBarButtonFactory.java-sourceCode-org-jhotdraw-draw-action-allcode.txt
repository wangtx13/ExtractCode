org jhotdraw draw action import org jhotdraw util * import awt * import awt event * import beans * import text * import util * import javax swing * import javax swing text * import org jhotdraw app action * import org jhotdraw draw AttributeKeys attribute keys * import org jhotdraw geom * import org jhotdraw draw * ToolBarButtonFactory tool bar button factory { Map<String map< color> DEFAULT_COLORS { LinkedHashMap<String linked hash map< color> = new LinkedHashMap<String linked hash map< color> put cayenne new color 128 0 0 put asparagus new color 128 128 0 put clover new color 0 128 0 put teal new color 0 128 128 put midnight new color 0 0 128 put plum new color 128 0 128 put tin new color 127 127 127 put nickel new color 128 128 128 put maraschino new color 255 0 0 put lemon new color 255 255 0 put spring new color 0 255 0 put turquoise new color 0 255 255 put blueberry new color 0 0 255 put magenta new color 255 0 255 put steel new color 102 102 102 put aluminium new color 153 153 153 put salmon new color 255 102 102 put banana new color 255 255 102 put flora new color 102 255 102 put ice new color 102 255 255 put orchid new color 102 102 255 put bubblegum new color 255 102 255 put iron new color 76 76 76 put magnesium new color 179 179 179 put mocha new color 128 64 0 put fern new color 64 128 0 put moss new color 0 128 64 put ocean new color 0 64 128 put eggplant new color 64 0 128 put maroon new color 128 0 64 put tungsten new color 51 51 51 put silver new color 204 204 204 put tangerine new color 255 128 0 put lime new color 128 255 0 put sea foam new color 0 255 128 put aqua new color 0 128 255 put grape new color 128 0 255 put strawberry new color 255 0 128 put new color 25 25 25 put mercury new color 230 230 230 put cantaloupe new color 255 204 102 put honeydew new color 204 255 102 put spindrift new color 102 255 204 put sky new color 102 204 255 put lavender new color 204 102 255 put carnation new color 255 111 207 put licorice new color 0 0 0 put snow new color 255 255 255 put transparent DEFAULT_COLORS = collections unmodifiableMap unmodifiable map } private ToolButtonListener tool button listener implements ItemListener item listener { private tool tool private DrawingEditor drawing editor editor ToolButtonListener tool button listener tool DrawingEditor drawing editor editor { this tool = this editor = editor } itemStateChanged item state changed ItemEvent item event evt { if evt getStateChange get state change == ItemEvent item event SELECTED { editor setTool set tool tool } } } private ToolBarButtonFactory tool bar button factory { } Collection<Action> collection< action> createDrawingActions create drawing actions DrawingEditor drawing editor editor { LinkedList<Action> linked list< action> = new LinkedList<Action> linked list< action> add new CutAction cut action add new CopyAction copy action add new PasteAction paste action add new SelectAllAction select all action add new SelectSameAction select same action editor } Collection<Action> collection< action> createSelectionActions create selection actions DrawingEditor drawing editor editor { LinkedList<Action> linked list< action> = new LinkedList<Action> linked list< action> add new DuplicateAction duplicate action add add new GroupAction group action editor add new UngroupAction ungroup action editor add add new MoveToFrontAction move to front action editor add new MoveToBackAction move to back action editor } addSelectionToolTo add selection tool to JToolBar tool bar tb DrawingEditor drawing editor editor { addSelectionToolTo add selection tool to tb editor createDrawingActions create drawing actions editor createSelectionActions create selection actions editor } addSelectionToolTo add selection tool to JToolBar tool bar tb DrawingEditor drawing editor editor Collection<Action> collection< action> drawingActions drawing actions Collection<Action> collection< action> selectionActions selection actions { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JToggleButton toggle button tool tool HashMap<String hash map< object> attributes ButtonGroup button group group if tb getClientProperty get client property toolButtonGroup tool button group instanceof ButtonGroup button group { group = ButtonGroup button group tb getClientProperty get client property toolButtonGroup tool button group } else { group = new ButtonGroup button group tb putClientProperty put client property toolButtonGroup tool button group group } tool selectionTool selection tool = new DelegationSelectionTool delegation selection tool drawingActions drawing actions selectionActions selection actions editor setTool set tool selectionTool selection tool = new JToggleButton toggle button JToggleButton toggle button defaultToolButton default tool button = ToolListener tool listener toolHandler tool handler if tb getClientProperty get client property toolHandler tool handler instanceof ToolListener tool listener { toolHandler tool handler = ToolListener tool listener tb getClientProperty get client property toolHandler tool handler } else { toolHandler tool handler = new ToolListener tool listener { toolStarted tool started ToolEvent tool event event { } toolDone tool done ToolEvent tool event event { defaultToolButton default tool button setSelected set selected } areaInvalidated area invalidated ToolEvent tool event { } } tb putClientProperty put client property toolHandler tool handler toolHandler tool handler } labels configureToolBarButton configure tool bar button selectionTool selection tool setSelected set selected addItemListener add item listener new ToolButtonListener tool button listener selectionTool selection tool editor setFocusable set focusable group add tb add } addToolTo add tool to JToolBar tool bar tb DrawingEditor drawing editor editor tool tool labelKey label key ResourceBundleUtil resource bundle util labels { ButtonGroup button group group = ButtonGroup button group tb getClientProperty get client property toolButtonGroup tool button group ToolListener tool listener toolHandler tool handler = ToolListener tool listener tb getClientProperty get client property toolHandler tool handler JToggleButton toggle button = new JToggleButton toggle button labels configureToolBarButton configure tool bar button labelKey label key addItemListener add item listener new ToolButtonListener tool button listener tool editor setFocusable set focusable tool addToolListener add tool listener toolHandler tool handler group add tb add } addZoomButtonsTo add zoom buttons to JToolBar tool bar bar DrawingEditor drawing editor editor { bar add createZoomButton create zoom button editor } AbstractButton button createZoomButton create zoom button DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button zoomPopupButton zoom popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button zoomPopupButton zoom popup button viewZoom view zoom zoomPopupButton zoom popup button setFocusable set focusable if editor getDrawingViews get drawing views size == 0 { zoomPopupButton zoom popup button setText set text 100 % } else { zoomPopupButton zoom popup button setText set text editor getDrawingViews get drawing views iterator next getScaleFactor get scale factor * 100 + % } editor addPropertyChangeListener add property change listener new PropertyChangeListener property change listener { propertyChange property change PropertyChangeEvent property change event evt { if evt getPropertyName get property == focusedView focused view { if evt getNewValue get new value == { zoomPopupButton zoom popup button setText set text 100 % } else { zoomPopupButton zoom popup button setText set text editor getFocusedView get focused view getScaleFactor get scale factor * 100 + % } } } } factors = {16 8 5 4 3 2 1 5 1 25 1 0 75 0 5 0 25 0 10} for i=0 < factors length i++ { zoomPopupButton zoom popup button add new ZoomEditorAction zoom editor action editor factors zoomPopupButton zoom popup button { actionPerformed action performed awt event ActionEvent action event { super actionPerformed action performed zoomPopupButton zoom popup button setText set text editor getView get view getScaleFactor get scale factor * 100 + % } } } zoomPopupButton zoom popup button setFocusable set focusable zoomPopupButton zoom popup button } AbstractButton button createZoomButton create zoom button DrawingView drawing view view { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button zoomPopupButton zoom popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button zoomPopupButton zoom popup button viewZoom view zoom zoomPopupButton zoom popup button setFocusable set focusable zoomPopupButton zoom popup button setText set text view getScaleFactor get scale factor * 100 + % view addPropertyChangeListener add property change listener new PropertyChangeListener property change listener { propertyChange property change PropertyChangeEvent property change event evt { if evt getPropertyName get property == scaleFactor scale factor { zoomPopupButton zoom popup button setText set text view getScaleFactor get scale factor * 100 + % } } } factors = {5 4 3 2 1 5 1 25 1 0 75 0 5 0 25 0 10} for i=0 < factors length i++ { zoomPopupButton zoom popup button add new ZoomAction zoom action view factors zoomPopupButton zoom popup button { actionPerformed action performed awt event ActionEvent action event { super actionPerformed action performed zoomPopupButton zoom popup button setText set text view getScaleFactor get scale factor * 100 + % } } } zoomPopupButton zoom popup button setFocusable set focusable zoomPopupButton zoom popup button } addAttributesButtonsTo add attributes buttons to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JButton button = bar add new PickAttributesAction pick attributes action editor setFocusable set focusable = bar add new ApplyAttributesAction apply attributes action editor setFocusable set focusable bar addSeparator add separator addColorButtonsTo add color buttons to bar editor bar addSeparator add separator addStrokeButtonsTo add stroke buttons to bar editor bar addSeparator add separator addFontButtonsTo add font buttons to bar editor } addColorButtonsTo add color buttons to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels addColorButtonTo add color button to bar editor STROKE_COLOR DEFAULT_COLORS 8 attributeStrokeColor attribute stroke color labels addColorButtonTo add color button to bar editor FILL_COLOR DEFAULT_COLORS 8 attributeFillColor attribute fill color labels addColorButtonTo add color button to bar editor TEXT_COLOR DEFAULT_COLORS 8 attributeTextColor attribute text color labels } addColorButtonTo add color button to JToolBar tool bar bar DrawingEditor drawing editor editor AttributeKey attribute key attributeKey attribute key Map<String map< color> colorMap color map columnCount column count labelKey label key ResourceBundleUtil resource bundle util labels { JPopupButton popup button popupButton popup button = new JPopupButton popup button popupButton popup button setAction set action new DefaultAttributeAction default attribute action editor attributeKey attribute key new rectangle 0 0 22 22 popupButton popup button setColumnCount set column count columnCount column count for map Entry<String entry< color> entry colorMap color map entrySet entry set { AttributeAction attribute action popupButton popup button add a= new AttributeAction attribute action editor attributeKey attribute key entry getValue get value new ColorIcon color icon entry getValue get value putValue put value action SHORT_DESCRIPTION entry getKey get key } ImageIcon image icon chooserIcon chooser icon = new ImageIcon image icon ToolBarButtonFactory tool bar button factory getResource get resource /org/jhotdraw/draw/action/images/showColorChooser /org/jhotdraw/draw/action/images/show color chooser png popupButton popup button add new ColorChooserAction color chooser action editor attributeKey attribute key chooserIcon chooser icon labels configureToolBarButton configure tool bar button popupButton popup button labelKey label key popupButton popup button setIcon set icon new ColorAttributeIcon color attribute icon editor attributeKey attribute key labels getImageIcon get image icon labelKey label key ToolBarButtonFactory tool bar button factory getImage get image popupButton popup button setFocusable set focusable editor addPropertyChangeListener add property change listener new PropertyChangeListener property change listener { propertyChange property change PropertyChangeEvent property change event evt { popupButton popup button repaint } } bar add popupButton popup button } addStrokeButtonsTo add stroke buttons to JToolBar tool bar bar DrawingEditor drawing editor editor { addStrokeDecorationButtonTo add stroke decoration button to bar editor addStrokeWidthButtonTo add stroke width button to bar editor addStrokeDashesButtonTo add stroke dashes button to bar editor addStrokeTypeButtonTo add stroke type button to bar editor addStrokePlacementButtonTo add stroke placement button to bar editor } addStrokeWidthButtonTo add stroke width button to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button strokeWidthPopupButton stroke width popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button strokeWidthPopupButton stroke width popup button attributeStrokeWidth attribute stroke width strokeWidthPopupButton stroke width popup button setFocusable set focusable widths = {0 5d 1d 2d 3d 5d 7d 9d 11d} NumberFormat number format formatter = NumberFormat number format getInstance get instance if formatter instanceof DecimalFormat decimal format { DecimalFormat decimal format formatter setMaximumFractionDigits set maximum fraction digits 1 DecimalFormat decimal format formatter setMinimumFractionDigits set minimum fraction digits 0 } for i=0 < widths length i++ { label = toString to widths strokeWidthPopupButton stroke width popup button add new AttributeAction attribute action editor STROKE_WIDTH new widths label new StrokeIcon stroke icon new BasicStroke basic stroke float widths BasicStroke basic stroke CAP_BUTT BasicStroke basic stroke JOIN_BEVEL } bar add strokeWidthPopupButton stroke width popup button } addStrokeDecorationButtonTo add stroke decoration button to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button strokeDecorationPopupButton stroke decoration popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button strokeDecorationPopupButton stroke decoration popup button attributeStrokeDecoration attribute stroke decoration strokeDecorationPopupButton stroke decoration popup button setFocusable set focusable strokeDecorationPopupButton stroke decoration popup button setColumnCount set column count 2 LineDecoration line decoration decorations = { new ArrowTip arrow tip 0 35 12 11 3 new ArrowTip arrow tip 0 35 13 7 } for i=0 < decorations length i++ { strokeDecorationPopupButton stroke decoration popup button add new AttributeAction attribute action editor START_DECORATION decorations new LineDecorationIcon line decoration icon decorations strokeDecorationPopupButton stroke decoration popup button add new AttributeAction attribute action editor END_DECORATION decorations new LineDecorationIcon line decoration icon decorations } bar add strokeDecorationPopupButton stroke decoration popup button } addStrokeDashesButtonTo add stroke dashes button to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button strokeDashesPopupButton stroke dashes popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button strokeDashesPopupButton stroke dashes popup button attributeStrokeDashes attribute stroke dashes strokeDashesPopupButton stroke dashes popup button setFocusable set focusable dashes = { {4d 4d} {2d 2d} {4d 2d} {2d 4d} {8d 2d} {6d 2d 2d 2d} } for i=0 < dashes length i++ { float fdashes if dashes == { fdashes = } else { fdashes = new float dashes length for = 0 < dashes length j++ { fdashes = float dashes } } strokeDashesPopupButton stroke dashes popup button add new AttributeAction attribute action editor STROKE_DASHES dashes new StrokeIcon stroke icon new BasicStroke basic stroke 2f BasicStroke basic stroke CAP_BUTT BasicStroke basic stroke JOIN_BEVEL 10f fdashes 0 } bar add strokeDashesPopupButton stroke dashes popup button } addStrokeTypeButtonTo add stroke type button to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button strokeTypePopupButton stroke type popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button strokeTypePopupButton stroke type popup button attributeStrokeType attribute stroke type strokeTypePopupButton stroke type popup button setFocusable set focusable strokeTypePopupButton stroke type popup button add new AttributeAction attribute action editor STROKE_TYPE AttributeKeys attribute keys StrokeType stroke type BASIC labels getString get attributeStrokeTypeBasic attribute stroke type basic new StrokeIcon stroke icon new BasicStroke basic stroke 1 BasicStroke basic stroke CAP_BUTT BasicStroke basic stroke JOIN_BEVEL HashMap<AttributeKey hash map< attribute key object> attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_TYPE AttributeKeys attribute keys StrokeType stroke type DOUBLE attr put STROKE_INNER_WIDTH_FACTOR 2d strokeTypePopupButton stroke type popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokeTypeDouble attribute stroke type new StrokeIcon stroke icon new DoubleStroke stroke 2 1 attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_TYPE AttributeKeys attribute keys StrokeType stroke type DOUBLE attr put STROKE_INNER_WIDTH_FACTOR 3d strokeTypePopupButton stroke type popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokeTypeDouble attribute stroke type new StrokeIcon stroke icon new DoubleStroke stroke 3 1 attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_TYPE AttributeKeys attribute keys StrokeType stroke type DOUBLE attr put STROKE_INNER_WIDTH_FACTOR 4d strokeTypePopupButton stroke type popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokeTypeDouble attribute stroke type new StrokeIcon stroke icon new DoubleStroke stroke 4 1 bar add strokeTypePopupButton stroke type popup button } addStrokePlacementButtonTo add stroke placement button to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button strokePlacementPopupButton stroke placement popup button = new JPopupButton popup button labels configureToolBarButton configure tool bar button strokePlacementPopupButton stroke placement popup button attributeStrokePlacement attribute stroke placement strokePlacementPopupButton stroke placement popup button setFocusable set focusable HashMap<AttributeKey hash map< attribute key object> attr attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement CENTER attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill CENTER strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementCenter attribute stroke placement center attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement INSIDE sid attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill CENTER strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementInside attribute stroke placement inside attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement OUTSIDE sid attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill CENTER strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementOutside attribute stroke placement outside attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement CENTER attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill FULL strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementCenterFilled attribute stroke placement center filled attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement INSIDE sid attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill FULL strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementInsideFilled attribute stroke placement inside filled attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement OUTSIDE sid attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill FULL strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementOutsideFilled attribute stroke placement outside filled attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement CENTER attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill NONE strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementCenterUnfilled attribute stroke placement center unfilled attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement INSIDE sid attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill NONE strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementInsideUnfilled attribute stroke placement inside unfilled attr = new HashMap<AttributeKey hash map< attribute key object> attr put STROKE_PLACEMENT AttributeKeys attribute keys StrokePlacement stroke placement OUTSIDE sid attr put FILL_UNDER_STROKE AttributeKeys attribute keys underfill NONE strokePlacementPopupButton stroke placement popup button add new AttributeAction attribute action editor attr labels getString get attributeStrokePlacementOutsideUnfilled attribute stroke placement outside unfilled bar add strokePlacementPopupButton stroke placement popup button } addFontButtonsTo add font buttons to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JPopupButton popup button fontPopupButton font popup button JButton button boldToggleButton bold toggle button JButton button italicToggleButton italic toggle button JButton button underlineToggleButton underline toggle button fontPopupButton font popup button = new JPopupButton popup button boldToggleButton bold toggle button = new JButton button italicToggleButton italic toggle button = new JButton button underlineToggleButton underline toggle button = new JButton button labels configureToolBarButton configure tool bar button fontPopupButton font popup button attributeFont attribute font fontPopupButton font popup button setFocusable set focusable font allFonts all fonts = GraphicsEnvironment graphics environment getLocalGraphicsEnvironment get local graphics environment getAllFonts get all fonts HashSet<String> hash set< string> fontExclusionList font exclusion list = new HashSet<String> hash set< string> arrays asList list new { #GungSeo # gung seo #HeadLineA # head line #PCMyungjo # myungjo #PilGi # pil gi bayan apple LiGothic gothic apple LiSung sung AppleMyungjo apple myungjo arial hebrew ayuthaya baghdad BiauKai biau kai charcoal CY corsiva hebrew DecoType deco type naskh devanagari MT fang song GB18030 b18030 bitmap geeza geezah geneva CY gujarati MT gurmukhi MT hei helvetica CY hiragino kaku gothic std hiragino maru gothic hiragino mincho hiragino kaku gothic InaiMathi inai mathi kai krungthep KufiStandardGK kufi standard LiHei hei LiSong song mshtakan monaco CY nadeem new peninim MT osaka plantagenet cherokee raanana STFangsong fangsong STHeiti heiti STKaiti kaiti STSong song sathu silom thonburi times CY arial unicode MS batang estrangelo edessa gautami kartika latha lucida sans unicode mangal marlett MS mincho MS outlook MV boli OCR-B-10 r- b-10 BT raavi shruti SimSun sim sun sylfaen symbol tunga vrinda wingdings wingdings 2 wingdings 3 ZWAdobeF z adobe } LinkedList<Font> linked list< font> fontList font list = new LinkedList<Font> linked list< font> for i=0 < allFonts all fonts length i++ { if ! fontExclusionList font exclusion list contains allFonts all fonts getFamily get family { fontList font list add allFonts all fonts } } allFonts all fonts = new font fontList font list size allFonts all fonts = font fontList font list toArray to allFonts all fonts arrays sort allFonts all fonts new Comparator<Font> comparator< font> { compare font f1 font f2 { result = f1 getFamily get family compareTo compare to f2 getFamily get family if result == 0 { result = f1 getFontName get font compareTo compare to f2 getFontName get font } result } } LinkedList<Font> linked list< font> fontFamilies font families = new LinkedList<Font> linked list< font> JMenu menu submenu = for i=0 < allFonts all fonts length i++ { if submenu != { if ! allFonts all fonts getFamily get family equals allFonts all fonts - 1 getFamily get family { submenu = } } if submenu == { if < allFonts all fonts length - 2 allFonts all fonts getFamily get family equals allFonts all fonts + 1 getFamily get family { fontFamilies font families add allFonts all fonts submenu = new JMenu menu allFonts all fonts getFamily get family fontPopupButton font popup button add submenu } } action action = new AttributeAction attribute action editor FONT_FACE allFonts all fonts submenu == ? allFonts all fonts getFamily get family allFonts all fonts getFontName get font new StyledEditorKit styled editor kit FontFamilyAction font family action allFonts all fonts getFontName get font allFonts all fonts getFamily get family if submenu == { fontFamilies font families add allFonts all fonts fontPopupButton font popup button add action } else { JMenuItem menu item item = submenu add action } } fontPopupButton font popup button setColumnCount set column count math max 1 fontFamilies font families size /32 labels configureToolBarButton configure tool bar button boldToggleButton bold toggle button attributeFontBold attribute font bold boldToggleButton bold toggle button setFocusable set focusable labels configureToolBarButton configure tool bar button italicToggleButton italic toggle button attributeFontItalic attribute font italic italicToggleButton italic toggle button setFocusable set focusable labels configureToolBarButton configure tool bar button underlineToggleButton underline toggle button attributeFontUnderline attribute font underline underlineToggleButton underline toggle button setFocusable set focusable boldToggleButton bold toggle button addActionListener add action listener new AttributeToggler attribute toggler editor FONT_BOLD TRUE FALSE new StyledEditorKit styled editor kit BoldAction bold action italicToggleButton italic toggle button addActionListener add action listener new AttributeToggler attribute toggler editor FONT_ITALIC TRUE FALSE new StyledEditorKit styled editor kit ItalicAction italic action underlineToggleButton underline toggle button addActionListener add action listener new AttributeToggler attribute toggler editor FONT_UNDERLINED TRUE FALSE new StyledEditorKit styled editor kit UnderlineAction underline action bar add fontPopupButton font popup button setFocusable set focusable bar add boldToggleButton bold toggle button setFocusable set focusable bar add italicToggleButton italic toggle button setFocusable set focusable bar add underlineToggleButton underline toggle button setFocusable set focusable } addAlignmentButtonsTo add alignment buttons to JToolBar tool bar bar DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels bar add new AlignAction align action west editor setFocusable set focusable bar add new AlignAction align action east editor setFocusable set focusable bar add new AlignAction align action horizontal editor setFocusable set focusable bar add new AlignAction align action north editor setFocusable set focusable bar add new AlignAction align action south editor setFocusable set focusable bar add new AlignAction align action vertical editor setFocusable set focusable bar addSeparator add separator bar add new MoveAction move action west editor setFocusable set focusable bar add new MoveAction move action east editor setFocusable set focusable bar add new MoveAction move action north editor setFocusable set focusable bar add new MoveAction move action south editor setFocusable set focusable bar addSeparator add separator bar add new MoveToFrontAction move to front action editor setFocusable set focusable bar add new MoveToBackAction move to back action editor setFocusable set focusable } AbstractButton button createToggleGridButton create toggle grid button DrawingEditor drawing editor editor { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JToggleButton toggle button toggleGridButton toggle grid button toggleGridButton toggle grid button = new JToggleButton toggle button labels configureToolBarButton configure tool bar button toggleGridButton toggle grid button alignGrid align grid toggleGridButton toggle grid button setFocusable set focusable toggleGridButton toggle grid button addItemListener add item listener new ItemListener item listener { itemStateChanged item state changed ItemEvent item event event { constrainer if toggleGridButton toggle grid button isSelected selected { = new GridConstrainer grid constrainer 10 10 } else { = new GridConstrainer grid constrainer 1 1 } for DrawingView drawing view editor getDrawingViews get drawing views { setConstrainer set constrainer getContainer get container repaint } } } toggleGridButton toggle grid button } AbstractButton button createToggleGridButton create toggle grid button DrawingView drawing view view { ResourceBundleUtil resource bundle util labels = ResourceBundleUtil resource bundle util getLAFBundle get bundle org jhotdraw draw labels JToggleButton toggle button toggleGridButton toggle grid button toggleGridButton toggle grid button = new JToggleButton toggle button labels configureToolBarButton configure tool bar button toggleGridButton toggle grid button alignGrid align grid toggleGridButton toggle grid button setFocusable set focusable toggleGridButton toggle grid button addItemListener add item listener new ItemListener item listener { itemStateChanged item state changed ItemEvent item event event { constrainer if toggleGridButton toggle grid button isSelected selected { = new GridConstrainer grid constrainer 10 10 } else { = new GridConstrainer grid constrainer 1 1 } view setConstrainer set constrainer view getContainer get container repaint } } view addPropertyChangeListener add property change listener new PropertyChangeListener property change listener { propertyChange property change PropertyChangeEvent property change event evt { if evt getPropertyName get property == gridConstrainer grid constrainer { constrainer = constrainer evt getNewValue get new value toggleGridButton toggle grid button setSelected set selected isVisible visible } } } toggleGridButton toggle grid button } } 