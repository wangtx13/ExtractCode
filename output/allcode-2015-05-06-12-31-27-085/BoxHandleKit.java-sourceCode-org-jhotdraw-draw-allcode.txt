org jhotdraw draw import util * import awt * import awt geom * import awt event * BoxHandleKit box handle kit { BoxHandleKit box handle kit { } addLeadHandles add handles figure Collection<Handle> collection< handle> handles { handles add southEast south east handles add southWest south west handles add northEast north east handles add northWest north west } addEdgeHandles add edge handles figure Collection<Handle> collection< handle> handles { handles add south handles add north handles add east handles add west } addBoxHandles add box handles figure Collection<Handle> collection< handle> handles { addLeadHandles add handles handles addEdgeHandles add edge handles handles } handle south figure owner { new SouthHandle south handle owner } handle southEast south east figure owner { new SouthEastHandle south east handle owner } handle southWest south west figure owner { new SouthWestHandle south west handle owner } handle north figure owner { new NorthHandle north handle owner } handle northEast north east figure owner { new NorthEastHandle north east handle owner } handle northWest north west figure owner { new NorthWestHandle north west handle owner } handle east figure owner { new EastHandle east handle owner } handle west figure owner { new WestHandle west handle owner } private ResizeHandle resize handle LocatorHandle locator handle { private dx dy geometry ResizeHandle resize handle figure owner locator { super owner } trackStart track start point anchor modifiersEx modifiers { geometry = getOwner get owner getRestoreData get restore data point location = getLocation get location dx = -anchor + location dy = -anchor + location } trackStep track step point anchor point modifiersEx modifiers { Point2D point2 = view viewToDrawing view to drawing new point + dx + dy view getConstrainer get constrainer constrainPoint constrain point trackStepNormalized track step normalized } trackEnd track point anchor point modifiersEx modifiers { fireUndoableEditHappened fire undoable edit happened new GeometryEdit geometry edit getOwner get owner geometry getOwner get owner getRestoreData get restore data } trackStepNormalized track step normalized Point2D point2 { } setBounds set bounds Point2D point2 anchor Point2D point2 { figure = getOwner get owner willChange will change Rectangle2D rectangle2 oldBounds old bounds = getBounds get bounds Rectangle2D rectangle2 newBounds new bounds = new Rectangle2D rectangle2 math min anchor math min anchor math anchor - math anchor - sx = newBounds new bounds width / oldBounds old bounds width = newBounds new bounds height / oldBounds old bounds height AffineTransform affine transform tx = new AffineTransform affine transform tx translate -oldBounds -old bounds -oldBounds -old bounds if ! isNaN sx ! isNaN sx != 1d || != 1d ! sx < 0 0001 ! < 0 0001 { basicTransform basic transform tx tx setToIdentity set to identity tx scale sx basicTransform basic transform tx tx setToIdentity set to identity } tx translate newBounds new bounds newBounds new bounds basicTransform basic transform tx changed } } private NorthEastHandle north east handle ResizeHandle resize handle { NorthEastHandle north east handle figure owner { super owner RelativeLocator relative locator northEast north east } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 math min + height - 1 new Point2D point2 math max + height } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor NE_RESIZE_CURSOR } } private EastHandle east handle ResizeHandle resize handle { EastHandle east handle figure owner { super owner RelativeLocator relative locator east } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 new Point2D point2 math max + 1 + height } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor E_RESIZE_CURSOR } } private NorthHandle north handle ResizeHandle resize handle { NorthHandle north handle figure owner { super owner RelativeLocator relative locator north } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 math min + height - 1 new Point2D point2 + width + height } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor N_RESIZE_CURSOR } } private NorthWestHandle north west handle ResizeHandle resize handle { NorthWestHandle north west handle figure owner { super owner RelativeLocator relative locator northWest north west } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 math min + width - 1 math min + height - 1 new Point2D point2 + width + height } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor NW_RESIZE_CURSOR } } private SouthEastHandle south east handle ResizeHandle resize handle { SouthEastHandle south east handle figure owner { super owner RelativeLocator relative locator southEast south east } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 new Point2D point2 math max + 1 math max + 1 } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor SE_RESIZE_CURSOR } } private SouthHandle south handle ResizeHandle resize handle { SouthHandle south handle figure owner { super owner RelativeLocator relative locator south } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 new Point2D point2 + width math max + 1 } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor S_RESIZE_CURSOR } } private SouthWestHandle south west handle ResizeHandle resize handle { SouthWestHandle south west handle figure owner { super owner RelativeLocator relative locator southWest south west } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 math min + width - 1 new Point2D point2 + width math max + 1 } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor SW_RESIZE_CURSOR } } private WestHandle west handle ResizeHandle resize handle { WestHandle west handle figure owner { super owner RelativeLocator relative locator west } trackStepNormalized track step normalized Point2D point2 { Rectangle2D rectangle2 = getOwner get owner getBounds get bounds setBounds set bounds new Point2D point2 math min + width - 1 new Point2D point2 + width + height } cursor getCursor get cursor { cursor getPredefinedCursor get predefined cursor cursor W_RESIZE_CURSOR } } } 