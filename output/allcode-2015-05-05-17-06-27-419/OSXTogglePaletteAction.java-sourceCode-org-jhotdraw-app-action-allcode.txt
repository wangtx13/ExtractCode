org jhotdraw app action import org jhotdraw util * import awt event * import javax swing * import util * import beans * import awt * import org jhotdraw app Default O S X Application O S X Toggle Palette Action Abstract Action { private Window palette private Default O S X Application app private Window Listener window Handler O S X Toggle Palette Action Default O S X Application app Window palette String label { super label this app = app window Handler = new Window Adapter { window Closing Window Event evt { put Value Actions SELECTED_KEY } } set Palette palette put Value Actions SELECTED_KEY } put Value String key Object new Value { super put Value key new Value if key == Actions SELECTED_KEY { if palette != { = Boolean new Value if { app add Palette palette palette set Visible } else { app remove Palette palette palette set Visible } } } } set Palette Window new Value { if palette != { palette remove Window Listener window Handler } palette = new Value if palette != { palette add Window Listener window Handler if get Value Actions SELECTED_KEY == Boolean T R U E { app add Palette palette palette set Visible } else { app remove Palette palette palette set Visible } } } action Performed Action Event { if palette != { put Value Actions SELECTED_KEY ! palette Visible } } } 