org jhotdraw app action import org jhotdraw util * import org jhotdraw gui * import org jhotdraw gui event * import awt * import awt event * import util * import util prefs * import javax swing * import * import org jhotdraw app Application import org jhotdraw app Project Open Action Abstract Application Action { String = open Open Action Application app { super app Resource Bundle Util labels = Resource Bundle Util get L A F Bundle org jhotdraw app Labels labels configure Action this } action Performed Action Event evt { Application app = get Application if app Enabled { app set Enabled Project empty Project = app get Current Project if empty Project == || empty Project get File != || empty Project has Unsaved Changes { empty Project = } Project if empty Project == { = app create Project app add } else { = empty Project } J File Chooser Chooser = get Open Chooser if Chooser show Open Dialog app get Component == J File Chooser APPROVE_OPTION { app show open File Chooser } else { app set Enabled } } } open File J File Chooser Chooser Project project { Application app = get Application File = Chooser get Selected File app set Enabled multiple Open Id = 1 for Project Project app projects { if Project != project Project get File != Project get File equals { multiple Open Id = Math max multiple Open Id Project get Multiple Open Id + 1 } } project set Multiple Open Id multiple Open Id project execute new Worker { Object construct { try { project read } catch Throwable { } } finished Object value { Opened project value } } } Opened Project project File Object value { Application app = get Application if value == { project set File project set Enabled Frame = Frame Swing Utilities get Window Ancestor project get Component if != { set Extended State get Extended State ~ Frame I C O N I F I E to Front } project get Component request Focus app add Recent File app set Enabled } else { if value instanceof Throwable { Throwable value Stack Trace } J Sheet show Message Sheet project get Component <html> + U I Manager get String Option Pane css + <b> Couldn't open the \ +file+ \ </b><br> + value J Option Pane ERROR_MESSAGE new Sheet Listener { option Selected Sheet Event evt { } } } } } 