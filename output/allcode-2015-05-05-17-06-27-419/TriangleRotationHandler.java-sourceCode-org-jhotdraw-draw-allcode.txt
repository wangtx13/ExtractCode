org jhotdraw draw import awt * import awt geom * import org jhotdraw draw Attribute Keys * import org jhotdraw geom * Triangle Rotation Handler Abstract Handle { private Rectangle center Box private Attribute Keys Orientation old Value private Attribute Keys Orientation new Value Triangle Rotation Handler Triangle Figure owner { super owner } Combinable With Handle { } private Point2 get Location { Rectangle2 = get Owner get Bounds Point2 offset = get Handlesize switch O R I E N T A T I O N get get Owner { case N O R T H default = new Point2 + width / 2d + offset break case NORTH_EAST = new Point2 + width - offset + offset break case E A S T = new Point2 + width - offset + height / 2d break case SOUTH_EAST = new Point2 + width - offset + height - offset break case S O U T H = new Point2 + width / 2d + height - offset break case SOUTH_WEST = new Point2 + offset + height - offset break case W E S T = new Point2 + offset + height / 2d break case NORTH_WEST = new Point2 + offset + offset break } } Rectangle basic Get Bounds { Point = view drawing To View get Location Rectangle = new Rectangle grow get Handlesize / 2 get Handlesize / 2 } track Start Point anchor modifiers Ex { old Value = O R I E N T A T I O N get get Owner center Box = view drawing To View get Owner get Bounds center Box grow center Box width / -3 center Box height / -3 } track Step Point anchor Point modifiers Ex { Rectangle Rect = new Rectangle switch Geom outcode center Box Rect { case Geom OUT_TOP default new Value = Attribute Keys Orientation N O R T H break case Geom OUT_TOP | Geom OUT_RIGHT new Value = Attribute Keys Orientation NORTH_EAST break case Geom OUT_RIGHT new Value = Attribute Keys Orientation E A S T break case Geom OUT_BOTTOM | Geom OUT_RIGHT new Value = Attribute Keys Orientation SOUTH_EAST break case Geom OUT_BOTTOM new Value = Attribute Keys Orientation S O U T H break case Geom OUT_BOTTOM | Geom OUT_LEFT new Value = Attribute Keys Orientation SOUTH_WEST break case Geom OUT_LEFT new Value = Attribute Keys Orientation W E S T break case Geom OUT_TOP | Geom OUT_LEFT new Value = Attribute Keys Orientation NORTH_WEST break } get Owner will Change O R I E N T A T I O N basic Set get Owner new Value get Owner changed update Bounds } draw Graphics2 { draw Diamond Color yellow Color black } track End Point anchor Point modifiers Ex { if new Value != old Value { fire Undoable Edit Happened new Attribute Change Edit get Owner O R I E N T A T I O N old Value new Value } } } 