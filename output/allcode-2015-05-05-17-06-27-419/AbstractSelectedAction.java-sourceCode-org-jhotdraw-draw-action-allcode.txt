org jhotdraw draw action import org jhotdraw draw Drawing import org jhotdraw draw Drawing Editor import org jhotdraw draw Drawing View import org jhotdraw draw Figure Selection Event import org jhotdraw draw Figure Selection Listener import javax swing * import beans * import javax swing undo * import org jhotdraw util * import util * Abstract Selected Action Abstract Action { private Drawing Editor editor Resource Bundle Util labels = Resource Bundle Util get L A F Bundle org jhotdraw draw Labels Locale get Default private Property Change Listener property Change Handler = new Property Change Listener { property Change Property Change Event evt { if evt get Property Name equals enabled { update Enabled State } } } private Event Handler implements Property Change Listener Figure Selection Listener { property Change Property Change Event evt { if evt get Property Name equals focused View { if evt get Old Value != { Drawing View view = Drawing View evt get Old Value view remove Figure Selection Listener this view remove Property Change Listener property Change Handler } if evt get New Value != { Drawing View view = Drawing View evt get New Value view add Figure Selection Listener this view add Property Change Listener property Change Handler } update Enabled State } } selection Changed Figure Selection Event evt { update Enabled State } } private Event Handler event Handler = new Event Handler Abstract Selected Action Drawing Editor editor { set Editor editor update Enabled State } update Enabled State { if get View != { set Enabled get View Enabled get View get Selection Count > 0 } else { set Enabled } } dispose { if this editor != { this editor remove Property Change Listener event Handler if this editor get View != { this editor get View remove Figure Selection Listener event Handler } } this editor = } set Editor Drawing Editor editor { if this editor != { this editor remove Property Change Listener event Handler if get View != { get View remove Figure Selection Listener event Handler } } this editor = editor if this editor != { this editor add Property Change Listener event Handler } } Drawing Editor get Editor { editor } Drawing View get View { editor == ? editor get Focused View } Drawing get Drawing { get View == ? get View get Drawing } fire Undoable Edit Happened Undoable Edit edit { get Drawing fire Undoable Edit Happened edit } } 