net n3 nanoxml import util Hashtable import Reader import String Reader Xml Entity Resolver implements I Xml Entity Resolver { private Hashtable entities Xml Entity Resolver { this entities = new Hashtable this entities put amp #38 this entities put quot #34 this entities put apos #39 this entities put lt #60 this entities put #62 } finalize Throwable { this entities clear this entities = super finalize } add Internal Entity String String value { if ! this entities contains Key { this entities put value } } add External Entity String String publicid String systemid { if ! this entities contains Key { this entities put new String { publicid systemid } } } Reader get Entity I Xml Reader xml Reader String Xml Parse Exception { Object = this entities get if == { } else if instanceof lang String { new String Reader String } else { String = String this open External Entity xml Reader 0 1 } } External Entity String { Object = this entities get ! instanceof lang String } Reader open External Entity I Xml Reader xml Reader String publicid String systemid Xml Parse Exception { String parent Systemid = xml Reader get Systemid try { xml Reader open Stream publicid systemid } catch Exception { new Xml Parse Exception parent Systemid xml Reader get Line Nr Could not open external entity + + systemid } } } 