org jhotdraw draw action import org jhotdraw draw * import org jhotdraw undo * import util * import javax swing * import javax swing undo * Ungroup Action Abstract Selected Action { String = selection Ungroup private Composite Figure prototype Ungroup Action Drawing Editor editor { this editor new Group Figure } Ungroup Action Drawing Editor editor Composite Figure prototype { super editor this prototype = prototype labels configure Action this } @ Override update Enabled State { if get View != { set Enabled can Ungroup } else { set Enabled } } can Ungroup { get View get Selection Count == 1 get View get Selected Figures iterator next get Class equals prototype get Class } action Performed awt event Action Event { if can Ungroup { Drawing View view = get View Composite Figure group = Composite Figure get View get Selected Figures iterator next Linked List< Figure> ungrouped Figures = new Linked List< Figure> Composite Edit edit = new Composite Edit labels get String selection Ungroup { redo Cannot Redo Exception { super redo ungroup Figures view group } undo Cannot Undo Exception { group Figures view group ungrouped Figures super undo } } fire Undoable Edit Happened edit ungrouped Figures add All ungroup Figures view group fire Undoable Edit Happened edit } } Collection< Figure> ungroup Figures Drawing View view Composite Figure group { Linked List< Figure> figures = new Linked List< Figure> group get Children view clear Selection group basic Remove All Children view get Drawing basic Add All figures view get Drawing remove group view add To Selection figures figures } group Figures Drawing View view Composite Figure group Collection< Figure> figures { Collection< Figure> sorted = view get Drawing sort figures view get Drawing basic Remove All figures view clear Selection view get Drawing add group group will Change for Figure sorted { group basic Add } group changed view add To Selection group } } 