org jhotdraw draw import org jhotdraw util * import awt * import awt geom * import org jhotdraw draw Attribute Keys * import org jhotdraw geom * Chop Box Connector Abstract Connector { Chop Box Connector { } Chop Box Connector Figure owner { super owner } Point2 find Start Connection Figure connection { Figure start Figure = connection get Start Connector get Owner Point2 from if connection get Point Count <= 2 || connection get Liner != { if connection get End Connector == { from = connection get End Point } else { Rectangle2 r1 = get Connector Target connection get End Connector get Owner get Bounds from = new Point2 r1 + r1 width/2 r1 + r1 height/2 } } else { from = connection get Point 1 } chop start Figure from } Point2 find End Connection Figure connection { Figure Figure = connection get End Connector get Owner Point2 from if connection get Point Count <= 2 || connection get Liner != { if connection get Start Connector == { from = connection get Start Point } else { Rectangle2 r1 = get Connector Target connection get Start Connector get Owner get Bounds from = new Point2 r1 + r1 width/2 r1 + r1 height/2 } } else { from = connection get Point connection get Point Count - 2 } chop Figure from } Point2 chop Figure target Point2 from { target = get Connector Target target Rectangle2 = target get Bounds if STROKE_COLOR get target != { grow switch STROKE_PLACEMENT get target { case C E N T E R default grow = Attribute Keys get Stroke Total Width target / 2d break case O U T Sid E grow = Attribute Keys get Stroke Total Width target break case I N Sid E grow = 0d break } Geom grow grow grow } Geom angle To Point Geom point To Angle from } } 