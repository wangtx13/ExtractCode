org jhotdraw draw action import org jhotdraw draw * import org jhotdraw undo * import util * import javax swing * import javax swing undo * Group Action Abstract Selected Action { String = selection Group private Composite Figure prototype Group Action Drawing Editor editor { this editor new Group Figure } Group Action Drawing Editor editor Composite Figure prototype { super editor this prototype = prototype labels configure Action this } @ Override update Enabled State { if get View != { set Enabled can Group } else { set Enabled } } can Group { get View get Selection Count > 1 } action Performed awt event Action Event { if can Group { Drawing View view = get View Linked List< Figure> ungrouped Figures = new Linked List< Figure> view get Selected Figures Composite Figure group = Composite Figure prototype clone Composite Edit edit = new Composite Edit labels get String selection Group { redo Cannot Redo Exception { super redo group Figures view group ungrouped Figures } undo Cannot Undo Exception { ungroup Figures view group super undo } add Edit Undoable Edit Edit { super add Edit Edit } } fire Undoable Edit Happened edit group Figures view group ungrouped Figures fire Undoable Edit Happened edit } } Collection< Figure> ungroup Figures Drawing View view Composite Figure group { Linked List< Figure> figures = new Linked List< Figure> group get Children view clear Selection group basic Remove All Children view get Drawing basic Add All figures view get Drawing remove group view add To Selection figures figures } group Figures Drawing View view Composite Figure group Collection< Figure> figures { Collection< Figure> sorted = view get Drawing sort figures view get Drawing basic Remove All figures view clear Selection view get Drawing add group group will Change for Figure sorted { group basic Add } group changed view add To Selection group } } 