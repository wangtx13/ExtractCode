org jhotdraw draw import org jhotdraw undo Composite Edit import awt * import awt geom * import awt event * import util * Creation Tool Abstract Tool { private Map< Attribute Key Object> attributes private String private Dimension minimal Size Treshold = new Dimension 10 10 private Dimension minimal Size = new Dimension 40 40 private Figure prototype Figure created Figure Composite Edit creation Edit Creation Tool String prototype Class Name { this prototype Class Name } Creation Tool String prototype Class Name Map< Attribute Key Object> attributes { this prototype Class Name attributes } Creation Tool String prototype Class Name Map< Attribute Key Object> attributes String { try { this prototype = Figure Class for Name prototype Class Name new Instance } catch Exception { Internal Error error = new Internal Error Unable to create Figure from +prototype Class Name error init Cause error } this attributes = attributes this = } Creation Tool Figure prototype { this prototype } Creation Tool Figure prototype Map< Attribute Key Object> attributes { this prototype attributes } Creation Tool Figure prototype Map< Attribute Key Object> attributes String { this prototype = prototype this attributes = attributes this = } Figure get Prototype { prototype } activate Drawing Editor editor { super activate editor } deactivate Drawing Editor editor { super deactivate editor if get View != { get View set Cursor Cursor get Default Cursor } if created Figure != { if created Figure instanceof Composite Figure { Composite Figure created Figure layout } created Figure = } } mouse Pressed Mouse Event evt { super mouse Pressed evt get View clear Selection creation Edit = new Composite Edit Figur erstellen get Drawing fire Undoable Edit Happened creation Edit created Figure = create Figure Point2 = constrain Point view To Drawing anchor anchor = evt get X anchor = evt get Y created Figure will Change created Figure basic Set Bounds created Figure changed get Drawing add created Figure } Figure create Figure { Figure = Figure prototype clone get Editor apply Default Attributes To if attributes != { for Map Entry< Attribute Key Object> entry attributes entry Set { set Attribute entry get Key entry get Value } } } Figure get Created Figure { created Figure } Figure get Added Figure { created Figure } mouse Dragged Mouse Event evt { if created Figure != { Point2 = constrain Point new Point evt get X evt get Y created Figure will Change created Figure basic Set Bounds constrain Point new Point anchor anchor created Figure changed } } mouse Released Mouse Event evt { if created Figure != { Rectangle2 bounds = created Figure get Bounds if bounds width == 0 bounds height == 0 { get Drawing remove created Figure } else { if Math anchor - evt get X < minimal Size Treshold width Math anchor - evt get Y < minimal Size Treshold height { created Figure basic Set Bounds constrain Point new Point anchor anchor constrain Point new Point anchor + Math max bounds width minimal Size width anchor + Math max bounds height minimal Size height } get View add To Selection created Figure } if created Figure instanceof Composite Figure { Composite Figure created Figure layout } created Figure = get Drawing fire Undoable Edit Happened creation Edit fire Tool Done } } } 