org jhotdraw draw action import org jhotdraw draw Drawing import org jhotdraw draw Drawing Editor import org jhotdraw draw Drawing View import org jhotdraw util * import beans * import javax swing * import javax swing undo * import util * Abstract View Action Abstract Action { private Drawing Editor editor private Drawing View view Resource Bundle Util labels = Resource Bundle Util get L A F Bundle org jhotdraw draw Labels Locale get Default private Property Change Listener property Change Handler = new Property Change Listener { property Change Property Change Event evt { if evt get Property Name equals enabled { update Enabled State } } } Abstract View Action Drawing Editor editor { this editor = editor editor add Property Change Listener new Property Change Listener { property Change Property Change Event evt { if evt get Property Name equals view { if evt get Old Value != { Drawing View view = Drawing View evt get Old Value view remove Property Change Listener property Change Handler } if evt get New Value != { Drawing View view = Drawing View evt get Old Value view add Property Change Listener property Change Handler update Enabled State } } } } } Abstract View Action Drawing View view { this view = view } set Editor Drawing Editor new Value { editor = new Value } Drawing View get View { view != ? view editor get View } Drawing get Drawing { get View get Drawing } fire Undoable Edit Happened Undoable Edit edit { get Drawing fire Undoable Edit Happened edit } view Changed { } update Enabled State { if get View != { set Enabled get View Enabled get View get Selection Count > 0 } else { set Enabled } } } 