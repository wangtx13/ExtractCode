org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * Bezier Control Point Handle Abstract Handle { index control Point Index private Composite Edit edit Bezier Control Point Handle Bezier Figure owner index coord { super owner this index = index this control Point Index = coord } Bezier Figure get Bezier Figure { Bezier Figure get Owner } Point get Location { get Bezier Figure get Point Count > index ? view drawing To View get Bezier Figure get Point index control Point Index new Point 10 10 } draw Graphics2 { Bezier Figure = get Bezier Figure if get Point Count > index { Bezier Path Node = get Node index if keep Colinear mask == Bezier Path C1C2_MASK index > 0 index < get Node Count || Closed { draw Circle Color white Color blue } else { draw Circle Color blue Color white } set Color Color blue draw new Line2 view drawing To View new Point2 0 0 view drawing To View new Point2 control Point Index control Point Index } } Rectangle basic Get Bounds { Rectangle = new Rectangle get Location grow get Handlesize / 2 get Handlesize / 2 } track Start Point anchor modifiers Ex { view get Drawing fire Undoable Edit Happened edit = new Composite Edit Punkt verschieben Point2 location = view get Constrainer constrain Point view view To Drawing get Location Point2 = view get Constrainer constrain Point view view To Drawing anchor } track Step Point anchor Point modifiers Ex { Bezier Figure figure = get Bezier Figure Point2 = view get Constrainer constrain Point view view To Drawing Bezier Path Node = figure get Node index fire Area Invalidated figure will Change if ! keep Colinear { figure basic Set Point index control Point Index } else { = Math P I + Math atan2 - 0 - 0 c2 = control Point Index == 1 ? 2 1 = Math sqrt c2 - 0 * c2 - 0 + c2 - 0 * c2 - 0 sina = Math sin cosa = Math cos Point2 p2 = new Point2 * cosa + 0 * sina + 0 figure basic Set Point index control Point Index figure basic Set Point index c2 p2 } figure changed fire Area Invalidated figure get Node index } private fire Area Invalidated Bezier Path Node { Rectangle2 dr = new Rectangle2 0 0 0 0 for i=1 < 3 i++ { dr add } Rectangle vr = view drawing To View dr vr grow get Handlesize get Handlesize fire Area Invalidated vr } track End Point anchor Point modifiers Ex { Bezier Figure figure = get Bezier Figure if modifiers Ex Input Event META_DOWN_MASK | Input Event CTRL_DOWN_MASK != 0 { figure will Change Bezier Path Node = figure get Node index keep Colinear = ! keep Colinear if keep Colinear { Point2 = figure get Point index control Point Index = Math P I + Math atan2 - 0 - 0 c2 = control Point Index == 1 ? 2 1 = Math sqrt c2 - 0 * c2 - 0 + c2 - 0 * c2 - 0 sina = Math sin cosa = Math cos Point2 p2 = new Point2 * cosa + 0 * sina + 0 c2 = p2 c2 = p2 } figure set Node index figure changed } view get Drawing fire Undoable Edit Happened edit } Combinable With Handle { if super Combinable With { Bezier Control Point Handle that = Bezier Control Point Handle that index == this index that control Point Index == this control Point Index that get Bezier Figure get Node Count == this get Bezier Figure get Node Count } } } 