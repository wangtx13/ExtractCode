org jhotdraw draw import org jhotdraw util * import javax swing undo * import awt geom * import util * Transform Edit Abstract Undoable Edit { private Collection< Figure> figures private Affine Transform tx Transform Edit Figure figure Affine Transform tx { figures = new Linked List< Figure> Linked List< Figure> figures add figure this tx = Affine Transform tx clone } Transform Edit Collection< Figure> figures Affine Transform tx { this figures = figures this tx = Affine Transform tx clone } String get Presentation Name { Resource Bundle Util labels = Resource Bundle Util get L A F Bundle org jhotdraw draw Labels Locale get Default labels get String transform Figure } add Edit Undoable Edit Edit { if Edit instanceof Transform Edit { Transform Edit that = Transform Edit Edit if that figures == this figures { this tx concatenate that tx that die } } } replace Edit Undoable Edit Edit { if Edit instanceof Transform Edit { Transform Edit that = Transform Edit Edit if that figures == this figures { this tx Concatenate that tx that die } } } redo Cannot Redo Exception { super redo for Figure figures { will Change basic Transform tx changed } } undo Cannot Undo Exception { super undo try { Affine Transform inverse = tx create Inverse for Figure figures { will Change basic Transform inverse changed } } catch Noninvertible Transform Exception { Stack Trace } } String to String { get Class get Name +'@'+hash Code + tx +tx } } 