org jhotdraw app import awt * import org jhotdraw beans * import org jhotdraw util * import util * import util prefs * import javax swing * import * Abstract Application Abstract Bean implements Application { private Linked List projects = new Linked List private Collection unmodifiable Documents private Enabled = Resource Bundle Util labels private Application Model model private Linked List< File> recent Files = new Linked List private max Recent Files Count = 10 private Preferences prefs Abstract Application { } init { prefs = Preferences user Node For Package get Model == ? get Class get Model get Class count = prefs get Int recent File Count 0 for i=0 < count i++ { String path = prefs get recent File +i if path != { recent Files add new File path } } if model != { model init Application this } } start { Project = create Project add show } Project create Project { Project = basic Create Project init if get Model != { get Model init Project this } init Project Actions } set Model Application Model new Value { Application Model old Value = model model = new Value fire Property Change model old Value new Value } Application Model get Model { model } Project basic Create Project { model create Project } String get Name { model get Name } String get Version { model get Version } String get Copyright { model get Copyright } init Project Actions Project stop { for Project new Linked List< Project> projects { dispose } System exit 0 } remove Project { hide old Count = projects size projects remove set Application fire Property Change project Count old Count projects size } add Project { if get Application != this { old Count = projects size projects add set Application this fire Property Change project Count old Count projects size } } dispose Project { remove dispose } Collection< Project> projects { if unmodifiable Documents == { unmodifiable Documents = Collections unmodifiable Collection projects } unmodifiable Documents } Enabled { Enabled } set Enabled new Value { old Value = Enabled Enabled = new Value fire Property Change enabled old Value new Value } Container create Container { new J Frame } launch String args { configure args Swing Utilities invoke Later new Runnable { run { init start } } } init Labels { labels = Resource Bundle Util get L A F Bundle org jhotdraw app Labels } configure String args { } util List< File> recent Files { Collections unmodifiable List recent Files } clear Recent Files { util List< File> old Value = util List< File> recent Files clone recent Files clear prefs put Int recent File Count recent Files size fire Property Change recent Files Collections unmodifiable List old Value Collections unmodifiable List recent Files } add Recent File File { util List< File> old Value = util List< File> recent Files clone if recent Files contains { recent Files remove } recent Files add First if recent Files size > max Recent Files Count { recent Files remove Last } prefs put Int recent File Count recent Files size i=0 for File recent Files { prefs put recent File +i get Path i++ } fire Property Change recent Files old Value 0 fire Property Change recent Files Collections unmodifiable List old Value Collections unmodifiable List recent Files } } 