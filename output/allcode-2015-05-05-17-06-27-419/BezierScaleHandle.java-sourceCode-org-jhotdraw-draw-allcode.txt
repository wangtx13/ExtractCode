org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * Bezier Scale Handle Abstract Handle { private Point location private Object restore Data private Affine Transform transform private Point2 center private start Theta private start Length Bezier Scale Handle Bezier Figure owner { super owner } Combinable With Handle { } draw Graphics2 { draw Circle Color yellow Color black } Rectangle basic Get Bounds { Rectangle = new Rectangle get Location grow get Handlesize / 2 get Handlesize / 2 } Point get Location { if location == { view drawing To View get Origin } location } private Bezier Figure get Bezier Figure { Bezier Figure get Owner } private Point2 get Origin { handlesize = get Handlesize Point2 outer = get Bezier Figure get Outermost Point Point2 ctr = get Bezier Figure get Center len = Geom length outer outer ctr ctr if len == 0 { new Point2 outer - handlesize/2 outer + handlesize/2 } = handlesize / len if > 1 0 { new Point2 outer * 3 + ctr /4 outer * 3 + ctr /4 } else { new Point2 outer * 1 0 - + ctr * outer * 1 0 - + ctr * } } track Start Point anchor modifiers Ex { location = new Point anchor anchor restore Data = get Bezier Figure get Restore Data transform = new Affine Transform center = get Bezier Figure get Center Point2 anchor Point = view view To Drawing anchor start Theta = Geom angle center center anchor Point anchor Point start Length = Geom length center center anchor Point anchor Point } track Step Point anchor Point modifiers Ex { location = new Point Point2 Point = view view To Drawing step Theta = Geom angle center center Point Point step Length = Geom length center center Point Point scale Factor = modifiers Ex Input Event ALT_DOWN_MASK | Input Event SHIFT_DOWN_MASK != 0 ? 1d step Length / start Length transform set To Identity transform translate center center transform scale scale Factor scale Factor transform rotate step Theta - start Theta transform translate -center -center get Owner will Change get Owner restore To restore Data get Owner basic Transform transform get Owner changed } track End Point anchor Point modifiers Ex { view get Drawing fire Undoable Edit Happened new Restore Data Edit get Owner restore Data location = } } 