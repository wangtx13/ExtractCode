org jhotdraw app action import org jhotdraw gui * import org jhotdraw gui event * import org jhotdraw util * import awt * import awt event * import javax swing * import * import org jhotdraw app Application import org jhotdraw app Project Export Action Abstract Project Action { String = export private Component old Focus Owner Export Action Application app { super app Resource Bundle Util labels = Resource Bundle Util get L A F Bundle org jhotdraw app Labels labels configure Action this } private J File Chooser get Export Chooser Project project { try { J File Chooser Methods invoke project get Export Chooser } catch Throwable { Internal Error error = new Internal Error Project does not support exporting error init Cause error } } action Performed Action Event evt { Project project = get Current Project if project Enabled { Resource Bundle Util labels = Resource Bundle Util get L A F Bundle org jhotdraw app Labels old Focus Owner = Swing Utilities get Window Ancestor project get Component get Focus Owner project set Enabled File save To File J File Chooser Chooser = get Export Chooser project J Sheet show Sheet Chooser project get Component labels get String filechooser export new Sheet Listener { option Selected Sheet Event evt { if evt get Option == J File Chooser APPROVE_OPTION { File = evt get File Chooser get Selected File export To File project evt get File Chooser get File Filter evt get File Chooser get Accessory } else { project set Enabled if old Focus Owner != { old Focus Owner request Focus } } } } } } export To File Project project File javax swing filechooser File Filter filter Component accessory { project execute new Worker { Object construct { try { Methods invoke project export new Class { File javax swing filechooser File Filter Component } filter accessory } catch Internal Error { get Cause != ? get Cause } catch Throwable { } } finished Object value { Exported project value } } } Exported Project project File Object value { if value == { } else { System out flush Throwable value Stack Trace J Sheet show Message Sheet project get Component <html> + U I Manager get String Option Pane css + <b> Couldn't export to the \ +file+ \ <p> + Reason +value J Option Pane ERROR_MESSAGE } project set Enabled Swing Utilities get Window Ancestor project get Component to Front if old Focus Owner != { old Focus Owner request Focus } } } 