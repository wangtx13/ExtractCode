org jhotdraw draw import awt * import awt geom * GridConstrainer grid constrainer implements constrainer { private width height private color minorColor minor color = new color 0xebebeb private color majorColor major color = new color 0xcacaca GridConstrainer grid constrainer width height { if width <= 0 || height <= 0 new IllegalArgumentException illegal argument width height <= 0 this width = width this height = height } getWidth get width { width } getHeight get height { height } Point2D point2 constrainPoint constrain point Point2D point2 { = math round / width * width = math round / height * height } toString to { super toString to + +width+ +height+ } isVisible visible { width > 1 height > 1 } draw Graphics2D graphics2 DrawingView drawing view view { if isVisible visible { AffineTransform affine transform = view getDrawingToViewTransform get drawing to view transform rectangle viewBounds view bounds = getClipBounds get clip bounds Rectangle2D rectangle2 bounds = view viewToDrawing view to drawing viewBounds view bounds Point2D point2 origin = constrainPoint constrain point new Point2D point2 bounds bounds Point2D point2 point = new Point2D point2 Point2D point2 viewPoint view point = new Point2D point2 if width * view getScaleFactor get scale factor > 1 { setColor set color minorColor minor color for i= origin / width = origin + bounds width / width + 1 <= i++ { setColor set color % 5 == 0 ? majorColor major color minorColor minor color point = width * transform point viewPoint view point drawLine draw line viewPoint view point viewBounds view bounds viewPoint view point viewBounds view bounds + viewBounds view bounds height } } if height * view getScaleFactor get scale factor > 1 { setColor set color minorColor minor color for i= origin / height = origin + bounds height / height + 1 <= i++ { setColor set color % 5 == 0 ? majorColor major color minorColor minor color point = height * transform point viewPoint view point drawLine draw line viewBounds view bounds viewPoint view point viewBounds view bounds + viewBounds view bounds width viewPoint view point } } } } } 