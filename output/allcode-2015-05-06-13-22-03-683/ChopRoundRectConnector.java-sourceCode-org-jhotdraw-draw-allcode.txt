org jhotdraw draw import org jhotdraw util * import awt * import awt geom * import org jhotdraw draw AttributeKeys attribute keys * import org jhotdraw geom * ChopRoundRectConnector chop round rect connector ChopBoxConnector chop box connector { ChopRoundRectConnector chop round rect connector { } ChopRoundRectConnector chop round rect connector figure owner { super owner } Point2D point2 chop figure target Point2D point2 from { target = getConnectorTarget get connector target target RoundRectangleFigure round rectangle figure rrf = RoundRectangleFigure round rectangle figure target Rectangle2D rectangle2 outer = rrf getBounds get bounds grow switch STROKE_PLACEMENT get target { case CENTER default grow = AttributeKeys attribute keys getStrokeTotalWidth get stroke total width target / 2d break case OUTSIDE sid grow = AttributeKeys attribute keys getStrokeTotalWidth get stroke total width target break case INSIDE sid grow = 0 break } geom grow outer grow grow Rectangle2D rectangle2 inner = Rectangle2D rectangle2 outer clone gw = rrf getArcWidth get arc width + grow * 2 / 2 gh = rrf getArcHeight get arc height + grow *2 / 2 inner = gw inner = gh inner width += gw * 2 inner height += gh * 2 angle = geom pointToAngle point to angle outer from Point2D point2 = geom angleToPoint angle to point outer geom pointToAngle point to angle outer from if == outer || == outer + outer width { = math min math max inner inner + inner height } else { = math min math max inner inner + inner width } } } 