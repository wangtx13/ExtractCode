org jhotdraw util prefs import awt * import awt event * import util prefs * import javax swing * PreferencesUtil preferences util { private PreferencesUtil preferences util { } installFramePrefsHandler install frame prefs handler preferences prefs window window { GraphicsConfiguration graphics configuration conf = window getGraphicsConfiguration get graphics configuration rectangle screenBounds screen bounds = conf getBounds get bounds insets screenInsets screen insets = window getToolkit get toolkit getScreenInsets get screen insets conf screenBounds screen bounds += screenInsets screen insets left screenBounds screen bounds += screenInsets screen insets top screenBounds screen bounds width = screenInsets screen insets left + screenInsets screen insets right screenBounds screen bounds height = screenInsets screen insets top + screenInsets screen insets bottom dimension preferredSize preferred size = window getPreferredSize get preferred size dimension minSize min size = window getMinimumSize get minimum size rectangle bounds = new rectangle prefs getInt get name+ 0 prefs getInt get name+ 0 math max minSize min size width prefs getInt get name+ width preferredSize preferred size width math max minSize min size height prefs getInt get name+ height preferredSize preferred size height if ! screenBounds screen bounds contains bounds { bounds = screenBounds screen bounds + screenBounds screen bounds width bounds width / 2 bounds = screenBounds screen bounds + screenBounds screen bounds height bounds height / 2 rectangle intersect screenBounds screen bounds bounds bounds } window setBounds set bounds bounds window addComponentListener add component listener new ComponentAdapter component adapter { componentMoved component moved ComponentEvent component event evt { prefs putInt put name+ evt getComponent get component getX get prefs putInt put name+ evt getComponent get component getY get } componentResized component resized ComponentEvent component event evt { prefs putInt put name+ width evt getComponent get component getWidth get width prefs putInt put name+ height evt getComponent get component getHeight get height } } } installPalettePrefsHandler install palette prefs handler preferences prefs window window { installPalettePrefsHandler install palette prefs handler prefs window 0 } installPalettePrefsHandler install palette prefs handler preferences prefs window window { GraphicsConfiguration graphics configuration conf = window getGraphicsConfiguration get graphics configuration rectangle screenBounds screen bounds = conf getBounds get bounds insets screenInsets screen insets = window getToolkit get toolkit getScreenInsets get screen insets conf screenBounds screen bounds += screenInsets screen insets left screenBounds screen bounds += screenInsets screen insets top screenBounds screen bounds width = screenInsets screen insets left + screenInsets screen insets right screenBounds screen bounds height = screenInsets screen insets top + screenInsets screen insets bottom dimension preferredSize preferred size = window getPreferredSize get preferred size rectangle bounds = new rectangle prefs getInt get name+ + screenBounds screen bounds prefs getInt get name+ 0 + screenBounds screen bounds preferredSize preferred size width preferredSize preferred size height if ! screenBounds screen bounds contains bounds { bounds = screenBounds screen bounds bounds = screenBounds screen bounds } window setBounds set bounds bounds window addComponentListener add component listener new ComponentAdapter component adapter { componentMoved component moved ComponentEvent component event evt { prefs putInt put name+ evt getComponent get component getX get prefs putInt put name+ evt getComponent get component getY get } } } installInternalFramePrefsHandler install internal frame prefs handler preferences prefs JInternalFrame internal frame window JDesktopPane desktop pane desktop { rectangle screenBounds screen bounds = desktop getBounds get bounds screenBounds screen bounds setLocation set location 0 0 insets screenInsets screen insets = desktop getInsets get insets screenBounds screen bounds += screenInsets screen insets left screenBounds screen bounds += screenInsets screen insets top screenBounds screen bounds width = screenInsets screen insets left + screenInsets screen insets right screenBounds screen bounds height = screenInsets screen insets top + screenInsets screen insets bottom dimension preferredSize preferred size = window getPreferredSize get preferred size dimension minSize min size = window getMinimumSize get minimum size rectangle bounds = new rectangle prefs getInt get name+ 0 prefs getInt get name+ 0 math max minSize min size width prefs getInt get name+ width preferredSize preferred size width math max minSize min size height prefs getInt get name+ height preferredSize preferred size height if ! screenBounds screen bounds contains bounds { bounds = screenBounds screen bounds + screenBounds screen bounds width bounds width / 2 bounds = screenBounds screen bounds + screenBounds screen bounds height bounds height / 2 rectangle intersect screenBounds screen bounds bounds bounds } window setBounds set bounds bounds window addComponentListener add component listener new ComponentAdapter component adapter { componentMoved component moved ComponentEvent component event evt { prefs putInt put name+ evt getComponent get component getX get prefs putInt put name+ evt getComponent get component getY get } componentResized component resized ComponentEvent component event evt { prefs putInt put name+ width evt getComponent get component getWidth get width prefs putInt put name+ height evt getComponent get component getHeight get height } } } installToolBarPrefsHandler install tool bar prefs handler preferences prefs JToolBar tool bar toolbar { new ToolBarPrefsHandler tool bar prefs handler toolbar prefs } } 