org jhotdraw draw action import javax swing * import util * import awt * import beans * import javax swing * import org jhotdraw draw * ColorChooserAction color chooser action AbstractSelectedAction selected action { private AttributeKey attribute key key private JColorChooser color chooser colorChooser color chooser ColorChooserAction color chooser action DrawingEditor drawing editor editor AttributeKey attribute key key { this editor key } ColorChooserAction color chooser action DrawingEditor drawing editor editor AttributeKey attribute key key icon icon { this editor key icon } ColorChooserAction color chooser action DrawingEditor drawing editor editor AttributeKey attribute key key { this editor key } ColorChooserAction color chooser action DrawingEditor drawing editor editor AttributeKey attribute key key icon icon { super editor this key = key putValue put value AbstractAction action NAME putValue put value AbstractAction action SMALL_ICON icon setEnabled set enabled } actionPerformed action performed awt event ActionEvent action event { if colorChooser color chooser == { colorChooser color chooser = new JColorChooser color chooser } color initialColor initial color = color getEditor get editor getDefaultAttribute get default attribute key if initialColor initial color == { initialColor initial color = color red } color chosenColor chosen color = colorChooser color chooser showDialog show dialog component getSource get source labels getString get drawColor draw color initialColor initial color if chosenColor chosen color != { changeAttribute change attribute chosenColor chosen color } } changeAttribute change attribute color value { drawing drawing = getDrawing get drawing iterator = getView get view getSelectedFigures get selected figures iterator while hasNext has next { figure figure = figure next figure setAttribute set attribute key value } getEditor get editor setDefaultAttribute set default attribute key value } selectionChanged selection changed FigureSelectionEvent figure selection event evt { } } 