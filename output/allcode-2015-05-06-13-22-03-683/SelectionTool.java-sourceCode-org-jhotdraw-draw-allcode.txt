org jhotdraw draw import awt * import awt event * SelectionTool selection tool AbstractTool tool implements ToolListener tool listener { private tool tracker SelectionTool selection tool { tracker = createAreaTracker create area tracker tracker addToolListener add tool listener this } activate DrawingEditor drawing editor editor { super activate editor tracker activate editor } deactivate DrawingEditor drawing editor editor { super deactivate editor tracker deactivate editor } keyPressed key pressed KeyEvent key event { tracker keyPressed key pressed } keyReleased key released KeyEvent key event evt { tracker keyReleased key released evt } keyTyped key typed KeyEvent key event evt { tracker keyTyped key typed evt } mouseClicked mouse clicked MouseEvent mouse event evt { tracker mouseClicked mouse clicked evt } mouseDragged mouse dragged MouseEvent mouse event evt { tracker mouseDragged mouse dragged evt } mouseEntered mouse entered MouseEvent mouse event evt { super mouseEntered mouse entered evt tracker mouseEntered mouse entered evt } mouseExited mouse exited MouseEvent mouse event evt { super mouseExited mouse exited evt tracker mouseExited mouse exited evt } mouseMoved mouse moved MouseEvent mouse event evt { tracker mouseMoved mouse moved evt } mouseReleased mouse released MouseEvent mouse event evt { tracker mouseReleased mouse released evt } draw Graphics2D graphics2 { tracker draw } mousePressed mouse pressed MouseEvent mouse event evt { super mousePressed mouse pressed evt DrawingView drawing view view = getView get view handle handle = view findHandle find handle anchor tool newTracker new tracker = if handle != { newTracker new tracker = createHandleTracker create handle tracker handle } else { figure figure = view findFigure find figure anchor if figure != { newTracker new tracker = createDragTracker create drag tracker figure } else { if ! evt isShiftDown shift down { view clearSelection clear selection view setHandleDetailLevel set handle detail level 0 } newTracker new tracker = createAreaTracker create area tracker } } if newTracker new tracker != { setTracker set tracker newTracker new tracker } tracker mousePressed mouse pressed evt } setTracker set tracker tool newTracker new tracker { if tracker != { tracker deactivate getEditor get editor tracker removeToolListener remove tool listener this } tracker = newTracker new tracker if tracker != { tracker activate getEditor get editor tracker addToolListener add tool listener this } } tool createHandleTracker create handle tracker handle handle { new HandleTracker handle tracker handle getView get view getCompatibleHandles get compatible handles handle } tool createDragTracker create drag tracker figure { new DragTracker drag tracker } tool createAreaTracker create area tracker { new SelectAreaTracker select area tracker } toolStarted tool started ToolEvent tool event event { } toolDone tool done ToolEvent tool event event { tool newTracker new tracker = createAreaTracker create area tracker if newTracker new tracker != { if tracker != { tracker deactivate getEditor get editor tracker removeToolListener remove tool listener this } tracker = newTracker new tracker tracker activate getEditor get editor tracker addToolListener add tool listener this } fireToolDone fire tool done } areaInvalidated area invalidated ToolEvent tool event { fireAreaInvalidated fire area invalidated getInvalidatedArea get invalidated area } } 