org jhotdraw draw import org jhotdraw util * import org jhotdraw undo * import awt * import awt event * import awt geom * import util * import org jhotdraw geom * rotate handle handle { private point location private restore data private affine transform transform private point2 center private start theta private start length rotate handle figure owner { super owner } combinable with handle { } draw graphics2 { draw diamond color green color black } rectangle basic get bounds { rectangle = new rectangle get location grow get handlesize / 2 get handlesize / 2 } point get location { if location == { view drawing to view get origin } location } private point2 get origin { rectangle2 bounds = get owner get bounds new point2 bounds get center bounds get handlesize } track start point anchor modifiers { location = new point anchor anchor restore data = get owner get restore data rectangle2 bounds = get owner get bounds transform = new affine transform center = new point2 bounds get center bounds get center point2 anchor point = view view to drawing anchor start theta = geom angle center center anchor point anchor point start length = geom length center center anchor point anchor point } track step point anchor point modifiers { location = new point point2 point = view view to drawing step theta = geom angle center center point point step length = geom length center center point point transform set to identity transform translate center center transform rotate step theta start theta transform translate center center get owner will change get owner restore to restore data get owner basic transform transform get owner changed } track point anchor point modifiers { view get drawing fire undoable edit happened new restore data edit get owner restore data location = } } 