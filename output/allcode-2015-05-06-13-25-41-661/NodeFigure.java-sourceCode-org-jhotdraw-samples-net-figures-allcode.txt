org jhotdraw samples net figures import awt * import awt geom * import util * import org jhotdraw draw * import org jhotdraw geom * import org jhotdraw draw attribute keys * import org jhotdraw util * node figure text figure { private linked list< connector> connectors private locator connector north private locator connector south private locator connector east private locator connector west node figure { rectangle figure = new rectangle figure set decorator create connectors set draw decorator first DECORATOR_INSETS set this new insets2 6 10 6 10 resource bundle util labels = resource bundle util get bundle org jhotdraw samples net labels set text labels get node default } private create connectors { connectors = new linked list< connector> connectors add new locator connector this new relative locator 0 5 0 connectors add new locator connector this new relative locator 0 5 1 connectors add new locator connector this new relative locator 1 0 5 connectors add new locator connector this new relative locator 0 0 5 for connector connectors { set visible } } @ collection< handle> create handles detail level { util list< handle> handles = new linked list< handle> if detail level == 0 { handles add new move handle this relative locator north west handles add new move handle this relative locator north east handles add new move handle this relative locator south west handles add new move handle this relative locator south east handles add new connection handle this relative locator north new line connection figure handles add new connection handle this relative locator east new line connection figure handles add new connection handle this relative locator south new line connection figure handles add new connection handle this relative locator west new line connection figure } handles } @ rectangle2 get figure draw bounds { rectangle2 = super get figure draw bounds geom grow 10d 10d } @ connector find connector point2 connection figure figure { min = MAX_VALUE connector closest = for connector connectors { point2 p2 = geom center get bounds = geom length2 p2 p2 if < min { min = closest = } } closest } @ connector find compatible connector connector start { connectors get first } node figure clone { node figure that = node figure super clone that create connectors that } @ draw connectors graphics2 { for connector connectors { draw } } @ get layer { 1 } set attribute attribute key key new value { super set attribute key new value if get decorator != { get decorator set attribute key new value } } } 