org jhotdraw util prefs import awt * import awt event * import util prefs * import javax swing * import javax swing plaf basic * import javax swing event * tool bar prefs handler implements component listener ancestor listener { private tool bar toolbar private prefs prefix private preferences prefs private first time shown tool bar prefs handler tool bar toolbar prefs prefix preferences prefs { this toolbar = toolbar this prefs prefix = prefs prefix this prefs = prefs constraint = prefs get prefs prefix+ constraint border layout orientation = constraint equals border layout || constraint equals border layout ? tool bar z tool bar toolbar set orientation orientation toolbar get parent add constraint toolbar toolbar set visible prefs get prefs prefix+ visible toolbar add component listener this toolbar add ancestor listener this } component hidden component event { prefs put prefs prefix+ visible } component moved component event { location changed } private location changed { if toolbar get instanceof basic tool bar { basic tool bar ui = basic tool bar toolbar get floating = ui floating prefs put prefs prefix+ floating floating if floating { window window = swing utilities get window ancestor toolbar prefs put prefs prefix+ floating window get prefs put prefs prefix+ floating window get } else if toolbar get parent != { = toolbar get = toolbar get insets insets = toolbar get parent get insets constraint if == insets left == insets top { constraint = toolbar get orientation == tool bar z ? border layout border layout } else { constraint = toolbar get orientation == tool bar z ? border layout border layout } prefs put prefs prefix+ constraint constraint } } else { if toolbar get parent != { = toolbar get = toolbar get insets insets = toolbar get parent get insets constraint if == insets left == insets top { constraint = toolbar get orientation == tool bar z ? border layout border layout } else { constraint = toolbar get orientation == tool bar z ? border layout border layout } prefs put prefs prefix+ constraint constraint } } } component resized component event { location changed } component shown component event { prefs put prefs prefix+ visible } ancestor added ancestor event event { location changed } ancestor moved ancestor event event { if toolbar get instanceof basic tool bar { if basic tool bar toolbar get floating { location changed } } } ancestor removed ancestor event event { if toolbar get instanceof basic tool bar { if basic tool bar toolbar get floating { location changed } } } } 