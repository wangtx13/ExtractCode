org jhotdraw app action import org jhotdraw gui * import org jhotdraw gui event * import org jhotdraw util * import awt * import awt event * import javax swing * import * import org jhotdraw app application import org jhotdraw app project export action project action { = export private component old focus owner export action application app { super app resource bundle util labels = resource bundle util get bundle org jhotdraw app labels labels configure action this } private chooser get export chooser project project { try { chooser project get export chooser } catch throwable { internal = new internal project does not support exporting init cause } } action performed action event evt { project project = get current project if project enabled { resource bundle util labels = resource bundle util get bundle org jhotdraw app labels old focus owner = swing utilities get window ancestor project get component get focus owner project set enabled save to chooser chooser = get export chooser project sheet show sheet chooser project get component labels get filechooser export new sheet listener { option selected sheet event evt { if evt get option == chooser APPROVE_OPTION { = evt get chooser get selected export to project evt get chooser get filter evt get chooser get accessory } else { project set enabled if old focus owner != { old focus owner request focus } } } } } } export to project project javax swing filechooser filter filter component accessory { project execute new worker { construct { try { project export new { javax swing filechooser filter component } filter accessory } catch internal { get cause != ? get cause } catch throwable { } } finished value { exported project value } } } exported project project value { if value == { } else { out flush throwable value stack trace sheet show message sheet project get component <html> + manager get option pane css + <b> couldn't export to the \ +file+ \ <p> + reason +value option pane ERROR_MESSAGE } project set enabled swing utilities get window ancestor project get component to front if old focus owner != { old focus owner request focus } } } 