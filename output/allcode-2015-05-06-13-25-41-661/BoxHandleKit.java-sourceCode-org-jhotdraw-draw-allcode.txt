org jhotdraw draw import util * import awt * import awt geom * import awt event * box handle kit { box handle kit { } add handles figure collection< handle> handles { handles add south east handles add south west handles add north east handles add north west } add edge handles figure collection< handle> handles { handles add south handles add north handles add east handles add west } add box handles figure collection< handle> handles { add handles handles add edge handles handles } handle south figure owner { new south handle owner } handle south east figure owner { new south east handle owner } handle south west figure owner { new south west handle owner } handle north figure owner { new north handle owner } handle north east figure owner { new north east handle owner } handle north west figure owner { new north west handle owner } handle east figure owner { new east handle owner } handle west figure owner { new west handle owner } private resize handle locator handle { private dx dy geometry resize handle figure owner locator { super owner } track start point anchor modifiers { geometry = get owner get restore data point location = get location dx = anchor + location dy = anchor + location } track step point anchor point modifiers { point2 = view view to drawing new point + dx + dy view get constrainer constrain point track step normalized } track point anchor point modifiers { fire undoable edit happened new geometry edit get owner geometry get owner get restore data } track step normalized point2 { } set bounds point2 anchor point2 { figure = get owner will change rectangle2 old bounds = get bounds rectangle2 new bounds = new rectangle2 math min anchor math min anchor math anchor math anchor sx = new bounds width / old bounds width = new bounds height / old bounds height affine transform tx = new affine transform tx translate old bounds old bounds if ! sx ! sx != 1d || != 1d ! sx < 0 0001 ! < 0 0001 { basic transform tx tx set to identity tx scale sx basic transform tx tx set to identity } tx translate new bounds new bounds basic transform tx changed } } private north east handle resize handle { north east handle figure owner { super owner relative locator north east } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 math min + height 1 new point2 math max + height } cursor get cursor { cursor get predefined cursor cursor NE_RESIZE_CURSOR } } private east handle resize handle { east handle figure owner { super owner relative locator east } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 new point2 math max + 1 + height } cursor get cursor { cursor get predefined cursor cursor E_RESIZE_CURSOR } } private north handle resize handle { north handle figure owner { super owner relative locator north } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 math min + height 1 new point2 + width + height } cursor get cursor { cursor get predefined cursor cursor N_RESIZE_CURSOR } } private north west handle resize handle { north west handle figure owner { super owner relative locator north west } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 math min + width 1 math min + height 1 new point2 + width + height } cursor get cursor { cursor get predefined cursor cursor NW_RESIZE_CURSOR } } private south east handle resize handle { south east handle figure owner { super owner relative locator south east } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 new point2 math max + 1 math max + 1 } cursor get cursor { cursor get predefined cursor cursor SE_RESIZE_CURSOR } } private south handle resize handle { south handle figure owner { super owner relative locator south } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 new point2 + width math max + 1 } cursor get cursor { cursor get predefined cursor cursor S_RESIZE_CURSOR } } private south west handle resize handle { south west handle figure owner { super owner relative locator south west } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 math min + width 1 new point2 + width math max + 1 } cursor get cursor { cursor get predefined cursor cursor SW_RESIZE_CURSOR } } private west handle resize handle { west handle figure owner { super owner relative locator west } track step normalized point2 { rectangle2 = get owner get bounds set bounds new point2 math min + width 1 new point2 + width + height } cursor get cursor { cursor get predefined cursor cursor W_RESIZE_CURSOR } } } 