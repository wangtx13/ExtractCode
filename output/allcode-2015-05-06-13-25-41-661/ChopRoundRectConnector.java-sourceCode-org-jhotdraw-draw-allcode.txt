org jhotdraw draw import org jhotdraw util * import awt * import awt geom * import org jhotdraw draw attribute keys * import org jhotdraw geom * chop round rect connector chop box connector { chop round rect connector { } chop round rect connector figure owner { super owner } point2 chop figure target point2 from { target = get connector target target round rectangle figure rrf = round rectangle figure target rectangle2 outer = rrf get bounds grow switch STROKE_PLACEMENT get target { case default grow = attribute keys get stroke total width target / 2d break case sid grow = attribute keys get stroke total width target break case sid grow = 0 break } geom grow outer grow grow rectangle2 inner = rectangle2 outer clone gw = rrf get arc width + grow * 2 / 2 gh = rrf get arc height + grow *2 / 2 inner = gw inner = gh inner width += gw * 2 inner height += gh * 2 angle = geom point to angle outer from point2 = geom angle to point outer geom point to angle outer from if == outer || == outer + outer width { = math min math max inner inner + inner height } else { = math min math max inner inner + inner width } } } 